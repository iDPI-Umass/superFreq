import"./CWj6FrbW.js";import{p as ue,b as fe,c as s,d as n,r,g as a,f as me,e as i,t as A,n as ge}from"./DKxP8oaF.js";import{s as w}from"./d8TzcK2t.js";import{i as f}from"./XPA7DDzn.js";import{e as ye,i as xe}from"./Cpe_MceB.js";import{t as _,a as l}from"./DCT9fmD9.js";import{a as he}from"./Pq-04fzQ.js";import{s as P}from"./DubPOQGL.js";import{d as we}from"./o4T939ll.js";import{p as V}from"./C6N4_jbr.js";import{e as be}from"./B9Qn1ecM.js";import{g as Ie}from"./ryZ2lNj1.js";import{p as B}from"./-Ocsa0V4.js";import{P as Ce}from"./BNhe8YCt.js";import{N as Te}from"./D1y81lpy.js";import{C as j}from"./mnVZ5n0Q.js";var Se=_("<span>feed</span>"),Ue=_('<div class="feed-item-one-liner"><p>Nothing in your feed? Try following some more <a href="/users">users</a> and <a href="/collections">collections</a>.</p></div>'),Me=_('<a><div class="feed-item-user-data"><!> </div></a> <div class="feed-post-spacer"><div class="feed-item-now-playing"><!></div></div>',1),Ye=_('<a><div class="feed-item-one-liner"><!> </div></a>'),ke=_('<a><div class="feed-item-one-liner"><!> </div></a>'),Ae=_('<a><div class="feed-item-one-liner"><!> </div></a>'),Pe=_('<a><div class="feed-item-one-liner"><!> <span class="blurb"> <span class="feed-item-subject"> </span></span></div></a>'),je=_('<a><div class="feed-item-one-liner"><!> <span class="blurb"> <span class="feed-item-subject"> </span></span></div></a>'),Ne=_('<a><div class="feed-item-one-liner"><!> <span class="blurb"> <span class="feed-item-subject">Top Albums</span> collection</span></div></a>'),Fe=_('<div class="feed-item"><!></div>'),Le=_('<div class="button-spacer svelte-gp797e"><button class="standard svelte-gp797e" formaction="?/loadMore">load more</button></div>'),He=()=>Ie("/feed"),Oe=_('<div class="button-spacer svelte-gp797e"><button class="standard svelte-gp797e">see more</button></div>'),qe=_('<div class="feed-panel"><!> <!> <!> <form method="POST" action="?/loadMore" class="svelte-gp797e"><!></form> <!></div>');function sa(se,t){ue(t,!0);let re=V(t,"userActionSuccess",3,null),te=V(t,"collections",19,()=>[]),X=V(t,"showCollectionsListModal",15,!1),Z=V(t,"showSaveSucessModal",15,!1);function M(o){return{img_url:o.avatar_url,last_fm_img_url:o.last_fm_avatar_url,artist_name:o.avatar_artist_name,release_group_name:o.avatar_release_group_name}}var W=qe(),$=s(W);Ce($,{headerText:e=>{var Y=Se();l(e,Y)}});var ee=n($,2);{var oe=o=>{var e=Ue();l(o,e)};f(ee,o=>{t.feedItems.length==0&&o(oe)})}var ae=n(ee,2);ye(ae,17,()=>t.feedItems,xe,(o,e)=>{var Y=Fe(),de=s(Y);{var ve=N=>{var G=Me(),F=me(G),J=s(F),m=s(J);const b=i(()=>M(a(e))),L=i(()=>`${a(e).display_name}'s avatar`);j(m,{get item(){return a(b)},get altText(){return a(L)},imgClass:"feed-avatar"});var H=n(m);r(J),r(F);var d=n(F,2),v=s(d),I=s(v);Te(I,{get sessionUserId(){return t.sessionUserId},get post(){return a(e)},mode:"feed",get userActionSuccess(){return re()},get collections(){return te()},get showCollectionsModal(){return X()},set showCollectionsModal(c){X(c)},get showSaveSucessModal(){return Z()},set showSaveSucessModal(c){Z(c)}}),r(v),r(d),A(c=>{P(F,"href",c),w(H,` ${(a(e).user_id==t.sessionUserId?"You":a(e).display_name)??""}
                    posted:`)},[()=>`/posts/${a(e).username}/now-playing/${B(a(e).timestamp)}`]),l(N,G)},ce=(N,G)=>{{var F=m=>{var b=Ye(),L=s(b),H=s(L);const d=i(()=>M(a(e))),v=i(()=>`${a(e).display_name}'s avatar`);j(H,{get item(){return a(d)},get altText(){return a(v)},imgClass:"feed-avatar"});var I=n(H);r(L),r(b),A(()=>{P(b,"href",`/user/${a(e).username}`),w(I,` ${a(e).display_name??""} followed you`)}),l(m,b)},J=(m,b)=>{{var L=d=>{var v=ke(),I=s(v),c=s(I);const C=i(()=>M(a(e))),T=i(()=>`${a(e).display_name}'s avatar`);j(c,{get item(){return a(C)},get altText(){return a(T)},imgClass:"feed-avatar"});var O=n(c);r(I),r(v),A((g,p)=>{P(v,"href",g),w(O,` ${(a(e).user_id==t.sessionUserId?"You":a(e).display_name)??""} commented on ${p??""} post`)},[()=>{var g;return`/posts/${a(e).parent_post_username}/now-playing/${B(a(e).parent_post_created_at)}#${(g=a(e).username)==null?void 0:g.concat(B(a(e).timestamp))}`},()=>a(e).parent_post_user_id==t.sessionUserId?"your":a(e).parent_post_display_name.concat("'s")]),l(d,v)},H=(d,v)=>{{var I=C=>{var T=Ae(),O=s(T),g=s(O);const p=i(()=>M(a(e))),S=i(()=>`${a(e).display_name}'s avatar`);j(g,{get item(){return a(p)},get altText(){return a(S)},imgClass:"feed-avatar"});var q=n(g);r(O),r(T),A((y,u)=>{P(T,"href",y),w(q,` ${(a(e).user_id==t.sessionUserId?"You":a(e).display_name)??""} liked ${u??""} ${(a(e).reaction_post_type=="now_playing "?"post":"reply")??""}`)},[()=>{var y;return a(e).reaction_post_type=="now_playing"?`/posts/${a(e).reaction_post_username}/now-playing/${B(a(e).reaction_post_created_at)}`:`/posts/${a(e).parent_post_username}/now-playing/${B(a(e).parent_post_created_at)}#${(y=a(e).reaction_post_username)==null?void 0:y.concat(B(a(e).reaction_post_created_at))}`},()=>a(e).reaction_post_user_id==t.sessionUserId?"your":a(e).reaction_post_display_name.concat("'s")]),l(C,T)},c=(C,T)=>{{var O=p=>{var S=Pe(),q=s(S),y=s(q);const u=i(()=>M(a(e))),U=i(()=>`${a(e).display_name}'s avatar`);j(y,{get item(){return a(u)},get altText(){return a(U)},imgClass:"feed-avatar"});var k=n(y,2),x=s(k),h=n(x),z=s(h,!0);r(h),r(k),r(q),r(S),A(()=>{P(S,"href",`/collection/${a(e).collection_id}`),w(x,`${(a(e).user_id==t.sessionUserId?"You":a(e).display_name)??""}
                      followed ${(a(e).collection_owner_id==t.sessionUserId?"your":"a")??""} collection: `),w(z,a(e).collection_title)}),l(p,S)},g=(p,S)=>{{var q=u=>{var U=je(),k=s(U),x=s(k);const h=i(()=>M(a(e))),z=i(()=>`${a(e).display_name}'s avatar`);j(x,{get item(){return a(h)},get altText(){return a(z)},imgClass:"feed-avatar"});var D=n(x,2),K=s(D),Q=n(K),R=s(Q,!0);r(Q),r(D),r(k),r(U),A(()=>{P(U,"href",`/collection/${a(e).collection_id}`),w(K,`${(a(e).user_id==t.sessionUserId?"You":a(e).display_name)??""}
                      edited the collection: `),w(R,a(e).collection_title)}),l(u,U)},y=(u,U)=>{{var k=x=>{var h=Ne(),z=s(h),D=s(z);const K=i(()=>M(a(e))),Q=i(()=>`${a(e).display_name}'s avatar`);j(D,{get item(){return a(K)},get altText(){return a(Q)},imgClass:"feed-avatar"});var R=n(D,2),pe=s(R);ge(2),r(R),r(z),r(h),A(()=>{P(h,"href",`/user/${a(e).username}`),w(pe,`${(a(e).user_id==t.sessionUserId?"You":a(e).display_name)??""}
                    edited their `)}),l(x,h)};f(u,x=>{a(e).item_type=="collection_edit"&&a(e).item_type.is_top_albums&&x(k)},U)}};f(p,u=>{a(e).item_type=="collection_edit"&&!a(e).item_type.is_top_albums?u(q):u(y,!1)},S)}};f(C,p=>{a(e).item_type=="collection_follow"&&a(e).user_id!=a(e).collection_owner_id?p(O):p(g,!1)},T)}};f(d,C=>{a(e).item_type=="reaction"?C(I):C(c,!1)},v)}};f(m,d=>{a(e).item_type=="comment"?d(L):d(H,!1)},b)}};f(N,m=>{a(e).item_type=="social_follow"&&a(e).target_user_id==t.sessionUserId?m(F):m(J,!1)},G)}};f(de,N=>{a(e).item_type=="now_playing_post"?N(ve):N(ce,!1)})}r(Y),l(o,Y)});var E=n(ae,2),ne=s(E);{var ie=o=>{var e=Le();l(o,e)};f(ne,o=>{t.remaining&&t.remaining>0&&o(ie)})}r(E),he(E,o=>{var e;return(e=be)==null?void 0:e(o)});var le=n(E,2);{var _e=o=>{var e=Oe(),Y=s(e);Y.__click=[He],r(e),l(o,e)};f(le,o=>{t.mode=="mini"&&o(_e)})}r(W),l(se,W),fe()}we(["click"]);export{sa as F};
