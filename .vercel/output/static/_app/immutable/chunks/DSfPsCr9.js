import"./CWj6FrbW.js";import{p as ke,a as ee,c as l,t as F,b as Ne,s as v,g as a,d as u,r as t,f as me,e as K}from"./DKxP8oaF.js";import{s as h}from"./d8TzcK2t.js";import{i as G}from"./XPA7DDzn.js";import{e as Ge,i as qe}from"./Cpe_MceB.js";import{t as P,a as m,d as Te,b as ge}from"./DCT9fmD9.js";import{s as _e,r as De}from"./DubPOQGL.js";import{d as Ue}from"./o4T939ll.js";import{b as Le}from"./Nvk8_zKA.js";import{p as L}from"./DIWzF7VF.js";import{p as R}from"./C6N4_jbr.js";import{L as Se}from"./BFwcLjEZ.js";import{m as Be,a as Fe,b as S,c as Re,i as ue,C as je,d as Oe,r as j,e as he,g as fe,f as Qe,h as Ee,j as He,k as Je}from"./mnVZ5n0Q.js";var Ke=P('Results for <span class="dialog-header svelte-ve0egz"> </span>',1),Ve=(ae,e,r,q)=>{e(r.mode,a(q))},We=P('<span class="list-modal"><span class="list-modal-bold"> </span> <br> <br> </span>'),Xe=P('<span class="list-modal"><span class="list-modal-bold"> </span> <br> </span>'),Ye=P('<span class="list-modal"><span class="list-modal-bold"> </span> <br> </span>'),Ze=P('<div class="result-image svelte-ve0egz"><!></div>'),pe=P('<li class="list-modal"><div class="list-modal-li-row"><div class="list-modal-li-row-button-spacing"><button class="add" aria-label="add item">+ add</button></div> <!></div> <!></li>'),$e=P('<ol class="list-modal"></ol>'),ea=P("<div><!></div>"),aa=(ae,e,r,q,B)=>e(r(),q.searchCategory,B()),ra=P('<div class="search-bar svelte-ve0egz"><!> <form class="search svelte-ve0egz"><button class="double-border-top"><div class="inner-border"> </div></button> <div class="input-sizing svelte-ve0egz"><input class="search" type="search" id="searchQuery" name="query" size="40"></div></form></div>');function ha(ae,e){ke(e,!0);let r=R(e,"addedItems",31,()=>L([])),q=R(e,"deletedItems",31,()=>L([])),B=R(e,"newItemAdded",15,!1),ie=R(e,"limit",3,"25"),f=R(e,"query",7,""),re=R(e,"imgPromise",15,null),k=ee(!1),V=ee(!1),W=ee(L([])),C=ee(!1);async function be(n,i,d){v(W,L([])),v(k,!0);const c=await Fe(n,i,d);return v(W,L(c.mbData)),v(C,L(c.searchComplete)),{mbData:a(W),searchComplete:a(C),showModal:a(k)}}const ye=["artists","release_groups","recordings"],Ce=Be(e.searchCategory);async function xe(n,i){if(v(V,!0),n=="single"){const d=await Oe(i,r(),e.searchCategory);if(r(d.addedItems),f(""),v(C,!1),B(!0),v(k,!1),e.searchCategory=="release_groups"||e.searchCategory=="recordings"){const c={mbid:he(e.searchCategory,i),artist_name:S(e.searchCategory,i),release_group_name:j(e.searchCategory,i)},{success:g,coverArtArchiveUrl:T,lastFmCoverArtUrl:x}=await fe(c);r(r().img_url=g?T:null,!0),r(r().last_fm_img_url=g?x:null,!0),re(new Promise(o=>o(g)))}return v(V,!1),{addedItems:r(),query:f(),searchComplete:a(C),newItemAdded:B(),showModal:a(k)}}if(n=="collection"){const d=await Qe(i,r(),q(),ie(),e.searchCategory,Ce);if(r(d.addedItems),q(d.deletedItems),f(""),v(C,!1),B(d.newItemAdded),v(k,!1),e.searchCategory=="release_groups"||e.searchCategory=="recordings"){const c=Ee(e.searchCategory,i),{success:g,coverArtArchiveUrl:T,lastFmCoverArtUrl:x}=await fe(c),o=r().findIndex(I=>I.release_group_mbid==c.mbid);r(r()[o].img_url=g?T:null,!0),r(r()[o].last_fm_img_url=g?x:null,!0),re(new Promise(I=>I(g)))}return v(V,!1),{addedItems:r(),deletedItems:q(),query:f(),searchComplete:a(C),newItemAdded:B(),showModal:a(k),imgPromise:re()}}}function Ie(n,i){return{artist_name:S(i,n),release_group_name:j(i,n),artist_mbid:He(i,n),release_group_mbid:he(i,n)}}var te=ra(),de=l(te);Se(de,{get showModal(){return a(k)},set showModal(d){v(k,L(d))},headerText:d=>{var c=Te(),g=me(c);{var T=o=>{var I=ge("Please enter valid input in the search bar.");m(o,I)},x=(o,I)=>{{var s=b=>{var D=ge("Loading...");m(b,D)},Q=(b,D)=>{{var Y=E=>{var Z=Ke(),p=u(me(Z)),se=l(p,!0);t(p),F(()=>h(se,f())),m(E,Z)};G(b,E=>{f()&&a(C)&&E(Y)},D)}};G(o,b=>{f()&&!a(C)?b(s):b(Q,!1)},I)}};G(g,o=>{f()?o(x,!1):o(T)})}m(d,c)},list:d=>{var c=ea(),g=l(c);{var T=x=>{var o=$e();Ge(o,21,()=>a(W),qe,(I,s)=>{var Q=pe(),b=l(Q),D=l(b),Y=l(D);Y.__click=[Ve,xe,e,s],t(D);var E=u(D,2);{var Z=y=>{var w=We(),U=l(w),H=l(U,!0);t(U);var _=u(U,3),A=u(_,2);t(w),F((M,z,N)=>{h(H,M),h(_,` ${z??""} `),h(A,` ${N??""}`)},[()=>S(e.searchCategory,a(s)),()=>Re(e.searchCategory,a(s)),()=>ue(e.searchCategory,a(s))]),m(y,w)},p=(y,w)=>{{var U=_=>{var A=Xe(),M=l(A),z=l(M,!0);t(M);var N=u(M),J=u(N,2);t(A),F((le,$,oe)=>{h(z,le),h(N,` by 
										${$??""} `),h(J,` ${oe??""}`)},[()=>j(e.searchCategory,a(s)),()=>S(e.searchCategory,a(s)),()=>ue(e.searchCategory,a(s))]),m(_,A)},H=(_,A)=>{{var M=z=>{var N=Ye(),J=l(N),le=l(J,!0);t(J);var $=u(J),oe=u($,2);t(N),F((Me,ze,Pe)=>{h(le,Me),h($,` by 
										${ze??""} `),h(oe,` ${Pe??""}`)},[()=>Je(e.searchCategory,a(s)),()=>S(e.searchCategory,a(s)),()=>j(e.searchCategory,a(s))]),m(z,N)};G(_,z=>{e.searchCategory=="recordings"&&z(M)},A)}};G(y,_=>{e.searchCategory=="release_groups"?_(U):_(H,!1)},w)}};G(E,y=>{e.searchCategory=="artists"?y(Z):y(p,!1)})}t(b);var se=u(b,2);{var Ae=y=>{var w=Ze(),U=l(w);const H=K(()=>Ie(a(s),e.searchCategory)),_=K(()=>S(e.searchCategory,a(s))),A=K(()=>j(e.searchCategory,a(s))),M=K(()=>j(e.searchCategory,a(s))),z=K(()=>S(e.searchCategory,a(s)));je(U,{get item(){return a(H)},get artistName(){return a(_)},get releaseGroupName(){return a(A)},get altText(){return`album ${a(M)??""} by artist ${a(z)??""}`}}),t(w),m(y,w)};G(se,y=>{(e.searchCategory=="release_groups"||e.searchCategory=="recordings")&&y(Ae)})}t(Q),F(()=>Y.disabled=a(V)),m(I,Q)}),t(o),m(x,o)};G(g,x=>{a(C)&&x(T)})}t(c),m(d,c)},$$slots:{headerText:!0,list:!0}});var ce=u(de,2),O=l(ce);O.__click=[aa,be,f,e,ie];var ne=l(O),we=l(ne,!0);t(ne),t(O);var ve=u(O,2),X=l(ve);De(X),t(ve),t(ce),t(te),F(n=>{O.disabled=n,h(we,e.searchButtonText),_e(X,"placeholder",e.searchPlaceholder),_e(X,"aria-label",e.searchPlaceholder)},[()=>!e.searchCategory||!ye.includes(e.searchCategory)]),Le(X,f),m(ae,te),Ne()}Ue(["click"]);export{ha as M};
