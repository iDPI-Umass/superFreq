import"./Bg9kRutz.js";import{p as ze,a as $,c as s,t as B,b as Pe,s as c,g as a,d as g,r as t,f as me,e as ee}from"./CIC73nbL.js";import{s as u}from"./zPX_AMPA.js";import{i as k}from"./w9zPIjBD.js";import{e as ke,i as Ne}from"./ChSzfhcg.js";import{t as M,a as n,d as Ge,b as ge}from"./D1sabymj.js";import{s as ue,r as qe}from"./pfHeeLMb.js";import{d as Te}from"./26D3B16x.js";import{b as De}from"./CpZvCGMu.js";import{p as L}from"./D8QYH9wd.js";import{p as F}from"./Cu7UW-DA.js";import{L as Ue}from"./acRpF1XP.js";import{m as Le,b as Se,c as R,d as Be,i as _e,C as Fe,e as Re,r as J,f as je,g as he,h as Oe,j as Qe,k as Ee}from"./CBTFtqMS.js";var He=M('Results for <span class="dialog-header svelte-ve0egz"> </span>',1),Je=(ae,e,r,N)=>{e(r.mode,a(N))},Ke=M('<span class="list-modal"><span class="list-modal-bold"> </span> <br> <br> </span>'),Ve=M('<span class="list-modal"><span class="list-modal-bold"> </span> <br> </span>'),We=M('<span class="list-modal"><span class="list-modal-bold"> </span> <br> </span>'),Xe=M('<div class="result-image svelte-ve0egz"><!></div>'),Ye=M('<li class="list-modal"><div class="list-modal-li-row"><div class="list-modal-li-row-button-spacing"><button class="add" aria-label="add item">+ add</button></div> <!></div> <!></li>'),Ze=M('<ol class="list-modal"></ol>'),pe=M("<div><!></div>"),$e=(ae,e,r,N,S)=>e(r(),N.searchCategory,S()),ea=M('<div class="search-bar svelte-ve0egz"><!> <form class="search svelte-ve0egz"><button class="double-border-top"><div class="inner-border"> </div></button> <div class="input-sizing svelte-ve0egz"><input class="search" type="search" id="searchQuery" name="query" size="40"></div></form></div>');function ua(ae,e){ze(e,!0);let r=F(e,"addedItems",31,()=>L([])),N=F(e,"deletedItems",31,()=>L([])),S=F(e,"newItemAdded",15,!1),ie=F(e,"limit",3,"25"),_=F(e,"query",7,""),re=F(e,"imgPromise",15,null),z=$(!1),K=$(!1),V=$(L([])),y=$(!1);async function fe(G,C,d){c(V,L([])),c(z,!0);const i=await Se(G,C,d);return c(V,L(i.mbData)),c(y,L(i.searchComplete)),{mbData:a(V),searchComplete:a(y),showModal:a(z)}}const ye=["artists","release_groups","recordings"],Ce=Le(e.searchCategory);async function be(G,C){if(c(K,!0),G=="single"){const d=await Re(C,r(),e.searchCategory);if(r(d.addedItems),_(""),c(y,!1),S(!0),c(z,!1),e.searchCategory=="release_groups"||e.searchCategory=="recordings"){const i={mbid:je(e.searchCategory,C),artist_name:R(e.searchCategory,C),release_group_name:J(e.searchCategory,C)},{success:v,coverArtArchiveUrl:q,lastFmCoverArtUrl:b}=await he(i);r(r().img_url=v?q:null,!0),r(r().last_fm_img_url=v?b:null,!0),re(new Promise(o=>o(v)))}return c(K,!1),{addedItems:r(),query:_(),searchComplete:a(y),newItemAdded:S(),showModal:a(z)}}if(G=="collection"){const d=await Oe(C,r(),N(),ie(),e.searchCategory,Ce);if(r(d.addedItems),N(d.deletedItems),_(""),c(y,!1),S(d.newItemAdded),c(z,!1),e.searchCategory=="release_groups"||e.searchCategory=="recordings"){const i=Qe(e.searchCategory,C),{success:v,coverArtArchiveUrl:q,lastFmCoverArtUrl:b}=await he(i),o=r().findIndex(x=>x.release_group_mbid==i.mbid);r(r()[o].img_url=v?q:null,!0),r(r()[o].last_fm_img_url=v?b:null,!0),re(new Promise(x=>x(v)))}return c(K,!1),{addedItems:r(),deletedItems:N(),query:_(),searchComplete:a(y),newItemAdded:S(),showModal:a(z),imgPromise:re()}}}var te=ea(),de=s(te);Ue(de,{get showModal(){return a(z)},set showModal(d){c(z,L(d))},headerText:d=>{var i=Ge(),v=me(i);{var q=o=>{var x=ge("Please enter valid input in the search bar.");n(o,x)},b=(o,x)=>{{var l=h=>{var T=ge("Loading...");n(h,T)},O=(h,T)=>{{var X=Q=>{var Y=He(),Z=g(me(Y)),se=s(Z,!0);t(Z),B(()=>u(se,_())),n(Q,Y)};k(h,Q=>{_()&&a(y)&&Q(X)},T)}};k(o,h=>{_()&&!a(y)?h(l):h(O,!1)},x)}};k(v,o=>{_()?o(b,!1):o(q)})}n(d,i)},list:d=>{var i=pe(),v=s(i);{var q=b=>{var o=Ze();ke(o,21,()=>a(V),Ne,(x,l)=>{var O=Ye(),h=s(O),T=s(h),X=s(T);X.__click=[Je,be,e,l],t(T);var Q=g(T,2);{var Y=f=>{var I=Ke(),D=s(I),E=s(D,!0);t(D);var m=g(D,3),w=g(m,2);t(I),B((A,U,P)=>{u(E,A),u(m,` ${U??""} `),u(w,` ${P??""}`)},[()=>R(e.searchCategory,a(l)),()=>Be(e.searchCategory,a(l)),()=>_e(e.searchCategory,a(l))]),n(f,I)},Z=(f,I)=>{{var D=m=>{var w=Ve(),A=s(w),U=s(A,!0);t(A);var P=g(A),H=g(P,2);t(w),B((le,p,oe)=>{u(U,le),u(P,` by 
										${p??""} `),u(H,` ${oe??""}`)},[()=>J(e.searchCategory,a(l)),()=>R(e.searchCategory,a(l)),()=>_e(e.searchCategory,a(l))]),n(m,w)},E=(m,w)=>{{var A=U=>{var P=We(),H=s(P),le=s(H,!0);t(H);var p=g(H),oe=g(p,2);t(P),B((we,Ae,Me)=>{u(le,we),u(p,` by 
										${Ae??""} `),u(oe,` ${Me??""}`)},[()=>Ee(e.searchCategory,a(l)),()=>R(e.searchCategory,a(l)),()=>J(e.searchCategory,a(l))]),n(U,P)};k(m,U=>{e.searchCategory=="recordings"&&U(A)},w)}};k(f,m=>{e.searchCategory=="release_groups"?m(D):m(E,!1)},I)}};k(Q,f=>{e.searchCategory=="artists"?f(Y):f(Z,!1)})}t(h);var se=g(h,2);{var Ie=f=>{var I=Xe(),D=s(I);const E=ee(()=>R(e.searchCategory,a(l))),m=ee(()=>J(e.searchCategory,a(l))),w=ee(()=>J(e.searchCategory,a(l))),A=ee(()=>R(e.searchCategory,a(l)));Fe(D,{get artistName(){return a(E)},get releaseGroupName(){return a(m)},get altText(){return`album ${a(w)??""} by artist ${a(A)??""}`}}),t(I),n(f,I)};k(se,f=>{(e.searchCategory=="release_groups"||e.searchCategory=="recordings")&&f(Ie)})}t(O),B(()=>X.disabled=a(K)),n(x,O)}),t(o),n(b,o)};k(v,b=>{a(y)&&b(q)})}t(i),n(d,i)},$$slots:{headerText:!0,list:!0}});var ce=g(de,2),j=s(ce);j.__click=[$e,fe,_,e,ie];var ne=s(j),xe=s(ne,!0);t(ne),t(j);var ve=g(j,2),W=s(ve);qe(W),t(ve),t(ce),t(te),B(G=>{j.disabled=G,u(xe,e.searchButtonText),ue(W,"placeholder",e.searchPlaceholder),ue(W,"aria-label",e.searchPlaceholder)},[()=>!e.searchCategory||!ye.includes(e.searchCategory)]),De(W,_),n(ae,te),Pe()}Te(["click"]);export{ua as M};
