const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/Bd3quSUI.js","../chunks/DOrtXGrH.js"])))=>i.map(i=>d[i]);
import{b as _n,e as He}from"../chunks/DOrtXGrH.js";import{_ as qt}from"../chunks/jKjWACjA.js";import{P as is,l as as,C as os}from"../chunks/CBTFtqMS.js";import"../chunks/Bg9kRutz.js";import{ak as hr,aM as pn,aN as mn,p as Ht,aO as ke,s as yr,aQ as wr,a4 as me,g as T,aP as Tr,f as J,b as Vt,t as nt,aR as yn,c as Ge,r as Xe,Z as bt,$ as wn,d as $,n as z,e as $e}from"../chunks/CIC73nbL.js";import{d as it,a as y,t as ee,b as ce}from"../chunks/D1sabymj.js";import{s as bn}from"../chunks/ChdiFDjO.js";import{o as kn}from"../chunks/CVs4c5cQ.js";import{e as En}from"../chunks/QnRASlD3.js";import{s as ls}from"../chunks/zPX_AMPA.js";import{i as Ze}from"../chunks/w9zPIjBD.js";import{c as E}from"../chunks/D1rop58F.js";import{h as Tn}from"../chunks/CZBN_KMn.js";import{d as kt,s as On}from"../chunks/pfHeeLMb.js";import"../chunks/69_IOA4Y.js";import{w as je,m as Fe,e as Qe,a as B,n as Xt,f as tt,g as le,F as cs,k as qe,p as Sn,b as Qt,d as Pn,S as zr,u as $n,z as rt,s as us,C as pt,c as Lt,j as Dr,o as Ds}from"../chunks/CentS020.js";import{e as Re}from"../chunks/26D3B16x.js";import{s as Je,e as An,t as Yt}from"../chunks/gG4CUbDX.js";import{a as Et}from"../chunks/BdK7rzmN.js";import{b as Tt}from"../chunks/CRtoN-tp.js";import{i as Or}from"../chunks/BwQo_Iph.js";import{c as xn,h as Ce,r as It,g as Cn,d as In,a as jn,b as Rn,C as lt}from"../chunks/DsF76e_X.js";import{l as zt,p as H,b as or,a as Sr}from"../chunks/Cu7UW-DA.js";import{w as Ie,d as rr}from"../chunks/CpzmMpJK.js";import{t as nr,g as ds,d as hs,u as fs,a as gs,b as Dn,s as Nt,r as Ln,o as mr,h as Un,f as Mn,c as Nn,e as Bn,i as Yr,v as Fn}from"../chunks/C1qF14Wh.js";import{h as qn}from"../chunks/BI-r1Rxu.js";const zn=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>qt(async()=>{const{default:r}=await Promise.resolve().then(()=>Wt);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Zr extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Kn extends Zr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Hn extends Zr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Vn extends Zr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Kr;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Kr||(Kr={}));var Wn=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):n(c.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};class Jn{constructor(e,{headers:t={},customFetch:r,region:n=Kr.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=zn(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Wn(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let u;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:u}).catch(p=>{throw new Kn(p)}),d=c.headers.get("x-relay-error");if(d&&d==="true")throw new Hn(c);if(!c.ok)throw new Vn(c);let h=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),g;return h==="application/json"?g=yield c.json():h==="application/octet-stream"?g=yield c.blob():h==="text/event-stream"?g=c:h==="multipart/form-data"?g=yield c.formData():g=yield c.text(),{data:g,error:null}}catch(n){return{data:null,error:n}}})}}var ze={},es={},Pr={},cr={},$r={},Ar={},Gn=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Kt=Gn();const Xn=Kt.fetch,Ls=Kt.fetch.bind(Kt),Us=Kt.Headers,Qn=Kt.Request,Yn=Kt.Response,Wt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Us,Request:Qn,Response:Yn,default:Ls,fetch:Xn},Symbol.toStringTag,{value:"Module"})),Zn=_n(Wt);var xr={};Object.defineProperty(xr,"__esModule",{value:!0});let ei=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};xr.default=ei;var Ms=He&&He.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ar,"__esModule",{value:!0});const ti=Ms(Zn),ri=Ms(xr);let si=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=ti.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l;let u=null,c=null,d=null,h=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const P=await i.text();P===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=P:c=JSON.parse(P))}const b=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),v=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");b&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,h=406,g="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const b=await i.text();try{u=JSON.parse(b),Array.isArray(u)&&i.status===404&&(c=[],u=null,h=200,g="OK")}catch{i.status===404&&b===""?(h=204,g="No Content"):u={message:b}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,h=200,g="OK"),u&&this.shouldThrowOnError)throw new ri.default(u)}return{error:u,data:c,count:d,status:h,statusText:g}});return this.shouldThrowOnError||(n=n.catch(i=>{var a,o,l;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}};Ar.default=si;var ni=He&&He.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty($r,"__esModule",{value:!0});const ii=ni(Ar);let ai=class extends ii.default{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${l};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};$r.default=ai;var oi=He&&He.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(cr,"__esModule",{value:!0});const li=oi($r);let ci=class extends li.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};cr.default=ci;var ui=He&&He.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Pr,"__esModule",{value:!0});const Zt=ui(cr);let di=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=t,this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){const n=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new Zt.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Zt.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Zt.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new Zt.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Zt.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Pr.default=di;var Cr={},Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.version=void 0;Ir.version="0.0.0-automated";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.DEFAULT_HEADERS=void 0;const hi=Ir;Cr.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${hi.version}`};var Ns=He&&He.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(es,"__esModule",{value:!0});const fi=Ns(Pr),gi=Ns(cr),vi=Cr;let _i=class Bs{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},vi.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new fi.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Bs(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:i}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let l;r||n?(a=r?"HEAD":"GET",Object.entries(t).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{o.searchParams.append(c,d)})):(a="POST",l=t);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new gi.default({method:a,url:o,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};es.default=_i;var Jt=He&&He.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ze,"__esModule",{value:!0});ze.PostgrestError=ze.PostgrestBuilder=ze.PostgrestTransformBuilder=ze.PostgrestFilterBuilder=ze.PostgrestQueryBuilder=ze.PostgrestClient=void 0;const Fs=Jt(es);ze.PostgrestClient=Fs.default;const qs=Jt(Pr);ze.PostgrestQueryBuilder=qs.default;const zs=Jt(cr);ze.PostgrestFilterBuilder=zs.default;const Ks=Jt($r);ze.PostgrestTransformBuilder=Ks.default;const Hs=Jt(Ar);ze.PostgrestBuilder=Hs.default;const Vs=Jt(xr);ze.PostgrestError=Vs.default;var pi=ze.default={PostgrestClient:Fs.default,PostgrestQueryBuilder:qs.default,PostgrestFilterBuilder:zs.default,PostgrestTransformBuilder:Ks.default,PostgrestBuilder:Hs.default,PostgrestError:Vs.default};const{PostgrestClient:mi,PostgrestQueryBuilder:Hl,PostgrestFilterBuilder:Vl,PostgrestTransformBuilder:Wl,PostgrestBuilder:Jl,PostgrestError:Gl}=pi,yi="2.11.2",wi={"X-Client-Info":`realtime-js/${yi}`},bi="1.0.0",Ws=1e4,ki=1e3;var Bt;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Bt||(Bt={}));var Ke;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Ke||(Ke={}));var We;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(We||(We={}));var Hr;(function(s){s.websocket="websocket"})(Hr||(Hr={}));var Ot;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Ot||(Ot={}));class Ei{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+n));a=a+n;const l=r.decode(e.slice(a,a+i));a=a+i;const u=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class Js{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var pe;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(pe||(pe={}));const vs=(s,e,t={})=>{var r;const n=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=Ti(a,s,e,n),i),{})},Ti=(s,e,t,r)=>{const n=e.find(o=>o.name===s),i=n==null?void 0:n.type,a=t[s];return i&&!r.includes(i)?Gs(i,a):Vr(a)},Gs=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return $i(e,t)}switch(s){case pe.bool:return Oi(e);case pe.float4:case pe.float8:case pe.int2:case pe.int4:case pe.int8:case pe.numeric:case pe.oid:return Si(e);case pe.json:case pe.jsonb:return Pi(e);case pe.timestamp:return Ai(e);case pe.abstime:case pe.date:case pe.daterange:case pe.int4range:case pe.int8range:case pe.money:case pe.reltime:case pe.text:case pe.time:case pe.timestamptz:case pe.timetz:case pe.tsrange:case pe.tstzrange:return Vr(e);default:return Vr(e)}},Vr=s=>s,Oi=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Si=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},Pi=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},$i=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let i;const a=s.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>Gs(e,o))}return s},Ai=s=>typeof s=="string"?s.replace(" ","T"):s,Xs=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Lr{constructor(e,t,r={},n=Ws){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var _s;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(_s||(_s={}));class ir{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ir.syncState(this.state,n,i,a),this.pendingDiffs.forEach(l=>{this.state=ir.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ir.syncDiff(this.state,n,i,a),o())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(u,c)=>{a[u]||(l[u]=c)}),this.map(a,(u,c)=>{const d=i[u];if(d){const h=c.map(v=>v.presence_ref),g=d.map(v=>v.presence_ref),p=c.filter(v=>g.indexOf(v.presence_ref)<0),b=d.filter(v=>h.indexOf(v.presence_ref)<0);p.length>0&&(o[u]=p),b.length>0&&(l[u]=b)}else o[u]=c}),this.syncDiff(i,{joins:o,leaves:l},r,n)}static syncDiff(e,t,r,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(o,l)=>{var u;const c=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),c.length>0){const d=e[o].map(g=>g.presence_ref),h=c.filter(g=>d.indexOf(g.presence_ref)<0);e[o].unshift(...h)}r(o,c,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const c=l.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[o]=u,n(o,u,l),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return"metas"in n?t[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ps;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(ps||(ps={}));var ms;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(ms||(ms={}));var st;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(st||(st={}));class ts{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Ke.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Lr(this,We.join,this.params,this.timeout),this.rejoinTimer=new Js(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ke.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ke.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this._on(We.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new ir(this),this.broadcastEndpointURL=Xs(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(c=>e==null?void 0:e(st.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(st.CLOSED));const l={},u={broadcast:i,presence:a,postgres_changes:(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var d;if(this.socket.setAuth(),c===void 0){e==null||e(st.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,g=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,p=[];for(let b=0;b<g;b++){const v=h[b],{filter:{event:P,schema:C,table:A,filter:O}}=v,S=c&&c[b];if(S&&S.event===P&&S.schema===C&&S.table===A&&S.filter===O)p.push(Object.assign(Object.assign({},v),{id:S.id}));else{this.unsubscribe(),e==null||e(st.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(st.SUBSCRIBED);return}}).receive("error",c=>{e==null||e(st.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(st.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ke.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(We.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const n=new Lr(this,We.leave,{},e);n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Lr(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:c}=We;if(r&&[o,l,u,c].indexOf(a)>=0&&r!==this._joinRef())return;let h=this._onMessage(a,t,r);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var p,b,v;return((p=g.filter)===null||p===void 0?void 0:p.event)==="*"||((v=(b=g.filter)===null||b===void 0?void 0:b.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===a}).map(g=>g.callback(h,r)):(i=this.bindings[a])===null||i===void 0||i.filter(g=>{var p,b,v,P,C,A;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in g){const O=g.id,S=(p=g.filter)===null||p===void 0?void 0:p.event;return O&&((b=t.ids)===null||b===void 0?void 0:b.includes(O))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((v=t.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const O=(C=(P=g==null?void 0:g.filter)===null||P===void 0?void 0:P.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return O==="*"||O===((A=t==null?void 0:t.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===a}).map(g=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:b,table:v,commit_timestamp:P,type:C,errors:A}=p;h=Object.assign(Object.assign({},{schema:b,table:v,commit_timestamp:P,eventType:C,new:{},old:{},errors:A}),this._getPayloadRecords(p))}g.callback(h,r)})}_isClosed(){return this.state===Ke.closed}_isJoined(){return this.state===Ke.joined}_isJoining(){return this.state===Ke.joining}_isLeaving(){return this.state===Ke.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ts.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(We.close,{},e)}_onError(e){this._on(We.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ke.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=vs(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=vs(e.columns,e.old_record)),t}}const xi=()=>{},Ci=typeof WebSocket<"u",Ii=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ji{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=wi,this.params={},this.timeout=Ws,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=xi,this.conn=null,this.sendBuffer=[],this.serializer=new Ei,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>qt(async()=>{const{default:l}=await Promise.resolve().then(()=>Wt);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${Hr.websocket}`,this.httpEndpoint=Xs(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Js(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Ci){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Ri(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),qt(async()=>{const{default:e}=await import("../chunks/Bd3quSUI.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1]),import.meta.url).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:bi}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Bt.connecting:return Ot.Connecting;case Bt.open:return Ot.Open;case Bt.closing:return Ot.Closing;default:return Ot.Closed}}isConnected(){return this.connectionState()===Ot.Open}channel(e,t={config:{}}){const r=new ts(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:n,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(n=>{t&&n.updateJoinPayload({access_token:t}),n.joinedOnce&&n._isJoined()&&n._push(We.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ki,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:n,payload:i,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${n} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(n,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(We.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Ii],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Ri{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Bt.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class rs extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Oe(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class Di extends rs{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Wr extends rs{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Li=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):n(c.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};const Qs=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>qt(async()=>{const{default:r}=await Promise.resolve().then(()=>Wt);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ui=()=>Li(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield qt(()=>Promise.resolve().then(()=>Wt),void 0,import.meta.url)).Response:Response}),Jr=s=>{if(Array.isArray(s))return s.map(t=>Jr(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Jr(r)}),e};var Pt=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):n(c.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};const Ur=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Mi=(s,e,t)=>Pt(void 0,void 0,void 0,function*(){const r=yield Ui();s instanceof r&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{e(new Di(Ur(n),s.status||500))}).catch(n=>{e(new Wr(Ur(n),n))}):e(new Wr(Ur(s),s))}),Ni=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),t))};function ur(s,e,t,r,n,i){return Pt(this,void 0,void 0,function*(){return new Promise((a,o)=>{s(t,Ni(e,r,n,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Mi(l,o,r))})})}function br(s,e,t,r){return Pt(this,void 0,void 0,function*(){return ur(s,"GET",e,t,r)})}function gt(s,e,t,r,n){return Pt(this,void 0,void 0,function*(){return ur(s,"POST",e,r,n,t)})}function Bi(s,e,t,r,n){return Pt(this,void 0,void 0,function*(){return ur(s,"PUT",e,r,n,t)})}function Fi(s,e,t,r){return Pt(this,void 0,void 0,function*(){return ur(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Ys(s,e,t,r,n){return Pt(this,void 0,void 0,function*(){return ur(s,"DELETE",e,r,n,t)})}var Be=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):n(c.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};const qi={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ys={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class zi{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Qs(n)}uploadOrUpdate(e,t,r,n){return Be(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},ys),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const u=this._removeEmptyFolders(t),c=this._getFinalPath(u),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),h=yield d.json();return d.ok?{data:{path:u,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(Oe(i))return{data:null,error:i};throw i}})}upload(e,t,r){return Be(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return Be(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:ys.upsert},n),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:c}),h=yield d.json();return d.ok?{data:{path:i,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(Oe(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Be(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const i=yield gt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new rs("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}update(e,t,r){return Be(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Be(this,void 0,void 0,function*(){try{return{data:yield gt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}copy(e,t,r){return Be(this,void 0,void 0,function*(){try{return{data:{path:(yield gt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,r){return Be(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield gt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,r){return Be(this,void 0,void 0,function*(){try{const n=yield gt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}download(e,t){return Be(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield br(this.fetch,`${this.url}/${n}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Oe(o))return{data:null,error:o};throw o}})}info(e){return Be(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield br(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Jr(r),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}exists(e){return Be(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Fi(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Oe(r)&&r instanceof Wr){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}remove(e){return Be(this,void 0,void 0,function*(){try{return{data:yield Ys(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Oe(t))return{data:null,error:t};throw t}})}list(e,t,r){return Be(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},qi),t),{prefix:e||""});return{data:yield gt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Ki="2.7.1",Hi={"X-Client-Info":`storage-js/${Ki}`};var jt=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):n(c.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};class Vi{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Hi),t),this.fetch=Qs(r)}listBuckets(){return jt(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Oe(e))return{data:null,error:e};throw e}})}getBucket(e){return jt(this,void 0,void 0,function*(){try{return{data:yield br(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Oe(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return jt(this,void 0,void 0,function*(){try{return{data:yield gt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return jt(this,void 0,void 0,function*(){try{return{data:yield Bi(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}emptyBucket(e){return jt(this,void 0,void 0,function*(){try{return{data:yield gt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Oe(t))return{data:null,error:t};throw t}})}deleteBucket(e){return jt(this,void 0,void 0,function*(){try{return{data:yield Ys(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Oe(t))return{data:null,error:t};throw t}})}}class Wi extends Vi{constructor(e,t={},r){super(e,t,r)}from(e){return new zi(this.url,this.headers,e,this.fetch)}}const Ji="2.49.1";let sr="";typeof Deno<"u"?sr="deno":typeof document<"u"?sr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?sr="react-native":sr="node";const Gi={"X-Client-Info":`supabase-js-${sr}/${Ji}`},Xi={headers:Gi},Qi={schema:"public"},Yi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Zi={};var ea=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):n(c.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};const ta=s=>{let e;return s?e=s:typeof fetch>"u"?e=Ls:e=fetch,(...t)=>e(...t)},ra=()=>typeof Headers>"u"?Us:Headers,sa=(s,e,t)=>{const r=ta(t),n=ra();return(i,a)=>ea(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:s;let u=new n(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",s),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},a),{headers:u}))})};var na=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):n(c.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};function ia(s){return s.replace(/\/$/,"")}function aa(s,e){const{db:t,auth:r,realtime:n,global:i}=s,{db:a,auth:o,realtime:l,global:u}=e,c={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},u),i),accessToken:()=>na(this,void 0,void 0,function*(){return""})};return s.accessToken?c.accessToken=s.accessToken:delete c.accessToken,c}const Zs="2.68.0",Ut=30*1e3,Gr=3,Mr=Gr*Ut,oa="http://localhost:9999",la="supabase.auth.token",ca={"X-Client-Info":`gotrue-js/${Zs}`},Xr="X-Supabase-Api-Version",en={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function ua(s){return Math.round(Date.now()/1e3)+s}function da(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const Ye=()=>typeof window<"u"&&typeof document<"u",mt={tested:!1,writable:!1},ar=()=>{if(!Ye())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(mt.tested)return mt.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),mt.tested=!0,mt.writable=!0}catch{mt.tested=!0,mt.writable=!1}return mt.writable};function ha(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((r,n)=>{e[n]=r}),e}const tn=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>qt(async()=>{const{default:r}=await Promise.resolve().then(()=>Wt);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},fa=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",rn=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},fr=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},gr=async(s,e)=>{await s.removeItem(e)};function ga(s){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,n,i,a,o,l,u,c=0;for(s=s.replace("-","+").replace("_","/");c<s.length;)a=e.indexOf(s.charAt(c++)),o=e.indexOf(s.charAt(c++)),l=e.indexOf(s.charAt(c++)),u=e.indexOf(s.charAt(c++)),r=a<<2|o>>4,n=(o&15)<<4|l>>2,i=(l&3)<<6|u,t=t+String.fromCharCode(r),l!=64&&n!=0&&(t=t+String.fromCharCode(n)),u!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class jr{constructor(){this.promise=new jr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}jr.promiseConstructor=Promise;function ws(s){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=s.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(ga(r))}async function va(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function _a(s,e){return new Promise((r,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await s(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function pa(s){return("0"+s.toString(16)).substr(-2)}function ma(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,pa).join("")}async function ya(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function wa(s){return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ba(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await ya(s);return wa(t)}async function Rt(s,e,t=!1){const r=ma();let n=r;t&&(n+="/PASSWORD_RECOVERY"),await rn(s,`${e}-code-verifier`,n);const i=await ba(r);return[i,r===i?"plain":"s256"]}const ka=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ea(s){const e=s.headers.get(Xr);if(!e||!e.match(ka))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class ss extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function K(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class Ta extends ss{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Oa(s){return K(s)&&s.name==="AuthApiError"}class sn extends ss{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class $t extends ss{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class ht extends $t{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Sa(s){return K(s)&&s.name==="AuthSessionMissingError"}class Nr extends $t{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class vr extends $t{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class _r extends $t{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Pa(s){return K(s)&&s.name==="AuthImplicitGrantRedirectError"}class bs extends $t{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qr extends $t{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Br(s){return K(s)&&s.name==="AuthRetryableFetchError"}class ks extends $t{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var $a=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};const yt=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Aa=[502,503,504];async function Es(s){var e;if(!fa(s))throw new Qr(yt(s),0);if(Aa.includes(s.status))throw new Qr(yt(s),s.status);let t;try{t=await s.json()}catch(i){throw new sn(yt(i),i)}let r;const n=Ea(s);if(n&&n.getTime()>=en["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new ks(yt(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ht}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new ks(yt(t),s.status,t.weak_password.reasons);throw new Ta(yt(t),s.status||500,r)}const xa=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),t))};async function se(s,e,t,r){var n;const i=Object.assign({},r==null?void 0:r.headers);i[Xr]||(i[Xr]=en["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Ca(s,e,t+o,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Ca(s,e,t,r,n,i){const a=xa(e,r,n,i);let o;try{o=await s(t,Object.assign({},a))}catch(l){throw console.error(l),new Qr(yt(l),0)}if(o.ok||await Es(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await Es(l)}}function ft(s){var e;let t=null;Da(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=ua(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function Ts(s){const e=ft(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function vt(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function Ia(s){return{data:s,error:null}}function ja(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:i}=s,a=$a(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Ra(s){return s}function Da(s){return s.access_token&&s.refresh_token&&s.expires_in}var La=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};class Ua{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=tn(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await se(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await se(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:vt})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=La(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:ja,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(K(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await se(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:vt})}catch(t){if(K(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,i,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Ra});if(c.error)throw c.error;const d=await c.json(),h=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,g=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return g.length>0&&(g.forEach(p=>{const b=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);u[`${v}Page`]=b}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(K(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await se(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:vt})}catch(t){if(K(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await se(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:vt})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await se(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:vt})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await se(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:r}}catch(t){if(K(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await se(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}}const Ma={getItem:s=>ar()?globalThis.localStorage.getItem(s):null,setItem:(s,e)=>{ar()&&globalThis.localStorage.setItem(s,e)},removeItem:s=>{ar()&&globalThis.localStorage.removeItem(s)}};function Os(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function Na(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Dt={debug:!!(globalThis&&ar()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class nn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ba extends nn{}async function Fa(s,e,t){Dt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Dt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){Dt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,n.name);try{return await t()}finally{Dt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,n.name)}}else{if(e===0)throw Dt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new Ba(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(Dt.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Na();const qa={url:oa,storageKey:la,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ca,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ss(s,e,t){return await t()}class lr{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=lr.nextInstanceID,lr.nextInstanceID+=1,this.instanceID>0&&Ye()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},qa),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Ua({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=tn(n.fetch),this.lock=n.lock||Ss,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Ye()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Fa:this.lock=Ss,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ar()?this.storage=Ma:(this.memoryStorage={},this.storage=Os(this.memoryStorage)):(this.memoryStorage={},this.storage=Os(this.memoryStorage)),Ye()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Zs}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=ha(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Ye()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Pa(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return K(t)?{error:t}:{error:new sn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const i=await se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:ft}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(K(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,n;try{let i;if("email"in e){const{email:c,password:d,options:h}=e;let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Rt(this.storage,this.storageKey)),i=await se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:c,password:d,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:g,code_challenge_method:p},xform:ft})}else if("phone"in e){const{phone:c,password:d,options:h}=e;i=await se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ft})}else throw new vr("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(K(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ts})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ts})}else throw new vr("You must provide either an email or phone number and a password");const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Nr}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(t){if(K(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await fr(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(t??"").split("/");try{const{data:i,error:a}=await se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ft});if(await gr(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Nr}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(K(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:i,nonce:a}=e,o=await se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ft}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Nr}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(K(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,i,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Rt(this.storage,this.storageKey));const{error:d}=await se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:c}=await se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new vr("You must provide either an email or phone number.")}catch(o){if(K(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:ft});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(n){if(K(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Rt(this.storage,this.storageKey)),await se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Ia})}catch(i){if(K(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ht;const{error:n}=await se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(K(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:a}=await se(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:n,options:i}=e,{data:a,error:o}=await se(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new vr("You must provide either an email or phone number and a type")}catch(t){if(K(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await fr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Mr:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:vt}):await this._useSession(async t=>{var r,n,i;const{data:a,error:o}=t;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ht}:await se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:vt})})}catch(t){if(K(t))return Sa(t)&&(await this._removeSession(),await gr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new ht;const a=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Rt(this.storage,this.storageKey));const{data:u,error:c}=await se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:vt});if(c)throw c;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return ws(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ht;const t=Date.now()/1e3;let r=t,n=!0,i=null;const a=ws(e.access_token);if(a.exp&&(r=a.exp,n=r<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(K(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new ht;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(K(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ye())throw new _r("No browser detected.");if(e.error||e.error_description||e.error_code)throw new _r(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new bs("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new _r("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new bs("No code detected.");const{data:C,error:A}=await this._exchangeCodeForSession(e.code);if(A)throw A;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=e;if(!i||!o||!a||!u)throw new _r("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(o);let h=c+d;l&&(h=parseInt(l));const g=h-c;g*1e3<=Ut&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${d}s`);const p=h-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,c);const{data:b,error:v}=await this._getUser(i);if(v)throw v;const P={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:d,expires_at:h,refresh_token:a,token_type:u,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:P,redirectType:e.type},error:null}}catch(r){if(K(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await fr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{error:i};const a=(r=n.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Oa(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await gr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=da(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:i},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await Rt(this.storage,this.storageKey,!0));try{return await se(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(K(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession(async i=>{var a,o,l,u,c;const{data:d,error:h}=i;if(h)throw h;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await se(this.fetch,"GET",g,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(n)throw n;return Ye()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(K(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:a}=t;if(a)throw a;return await se(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(K(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await _a(async n=>(n>0&&await va(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ft})),(n,i)=>{const a=200*Math.pow(2,n);return i&&Br(i)&&Date.now()+a-r<Ut})}catch(r){if(this._debug(t,"error",r),K(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Ye()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await fr(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const n=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Mr;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${Mr}s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),Br(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ht;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new jr;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new ht;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),K(i)){const a={session:null,error:i};return Br(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await rn(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await gr(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ye()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ut);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/Ut);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ut}ms, refresh threshold is ${Gr} ticks`),n<=Gr&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof nn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ye()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await Rt(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(o.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await se(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(K(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await se(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(K(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(K(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(K(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],n=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}}lr.nextInstanceID=0;const za=lr;class Ka extends za{constructor(e){super(e)}}var Ha=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?i(c.value):n(c.value).then(o,l)}u((r=r.apply(s,e||[])).next())})};class Va{constructor(e,t,r){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=ia(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:Qi,realtime:Zi,auth:Object.assign(Object.assign({},Yi),{storageKey:l}),global:Xi},c=aa(r??{},u);this.storageKey=(n=c.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=c.auth)!==null&&a!==void 0?a:{},this.headers,c.global.fetch),this.fetch=sa(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new mi(`${o}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new Jn(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Wi(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Ha(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:a,lock:o,debug:l},u,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ka({url:this.authUrl,headers:Object.assign(Object.assign({},d),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:a,lock:o,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new ji(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const an=(s,e,t)=>new Va(s,e,t),on="0.5.2";/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var Wa=to,Ja=ro,Ga=Object.prototype.toString,Xa=Object.prototype.hasOwnProperty,Qa=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,Ya=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,Za=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,eo=/^[\u0020-\u003A\u003D-\u007E]*$/;function to(s,e){if(typeof s!="string")throw new TypeError("argument str must be a string");var t={},r=s.length;if(r<2)return t;var n=e&&e.decode||so,i=0,a=0,o=0;do{if(a=s.indexOf("=",i),a===-1)break;if(o=s.indexOf(";",i),o===-1)o=r;else if(a>o){i=s.lastIndexOf(";",a-1)+1;continue}var l=Ps(s,i,a),u=$s(s,a,l),c=s.slice(l,u);if(!Xa.call(t,c)){var d=Ps(s,a+1,o),h=$s(s,o,d);s.charCodeAt(d)===34&&s.charCodeAt(h-1)===34&&(d++,h--);var g=s.slice(d,h);t[c]=io(g,n)}i=o+1}while(i<r);return t}function Ps(s,e,t){do{var r=s.charCodeAt(e);if(r!==32&&r!==9)return e}while(++e<t);return t}function $s(s,e,t){for(;e>t;){var r=s.charCodeAt(--e);if(r!==32&&r!==9)return e+1}return t}function ro(s,e,t){var r=t&&t.encode||encodeURIComponent;if(typeof r!="function")throw new TypeError("option encode is invalid");if(!Qa.test(s))throw new TypeError("argument name is invalid");var n=r(e);if(!Ya.test(n))throw new TypeError("argument val is invalid");var i=s+"="+n;if(!t)return i;if(t.maxAge!=null){var a=Math.floor(t.maxAge);if(!isFinite(a))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+a}if(t.domain){if(!Za.test(t.domain))throw new TypeError("option domain is invalid");i+="; Domain="+t.domain}if(t.path){if(!eo.test(t.path))throw new TypeError("option path is invalid");i+="; Path="+t.path}if(t.expires){var o=t.expires;if(!no(o)||isNaN(o.valueOf()))throw new TypeError("option expires is invalid");i+="; Expires="+o.toUTCString()}if(t.httpOnly&&(i+="; HttpOnly"),t.secure&&(i+="; Secure"),t.partitioned&&(i+="; Partitioned"),t.priority){var l=typeof t.priority=="string"?t.priority.toLowerCase():t.priority;switch(l){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(t.sameSite){var u=typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite;switch(u){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return i}function so(s){return s.indexOf("%")!==-1?decodeURIComponent(s):s}function no(s){return Ga.call(s)==="[object Date]"}function io(s,e){try{return e(s)}catch{return s}}function Ft(){return typeof window<"u"&&typeof window.document<"u"}const St={path:"/",sameSite:"lax",httpOnly:!1,maxAge:400*24*60*60},ao=3180,oo=/^(.*)[.](0|[1-9][0-9]*)$/;function kr(s,e){if(s===e)return!0;const t=s.match(oo);return!!(t&&t[1]===e)}function ln(s,e,t){const r=ao;let n=encodeURIComponent(e);if(n.length<=r)return[{name:s,value:e}];const i=[];for(;n.length>0;){let a=n.slice(0,r);const o=a.lastIndexOf("%");o>r-3&&(a=a.slice(0,o));let l="";for(;a.length>0;)try{l=decodeURIComponent(a);break}catch(u){if(u instanceof URIError&&a.at(-3)==="%"&&a.length>3)a=a.slice(0,a.length-3);else throw u}i.push(l),n=n.slice(a.length)}return i.map((a,o)=>({name:`${s}.${o}`,value:a}))}async function As(s,e){const t=await e(s);if(t)return t;let r=[];for(let n=0;;n++){const i=`${s}.${n}`,a=await e(i);if(!a)break;r.push(a)}return r.length>0?r.join(""):null}const Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),xs=` 	
\r=`.split(""),lo=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<xs.length;e+=1)s[xs[e].charCodeAt(0)]=-2;for(let e=0;e<Er.length;e+=1)s[Er[e].charCodeAt(0)]=e;return s})();function cn(s){const e=[];let t=0,r=0;if(uo(s,i=>{for(t=t<<8|i,r+=8;r>=6;){const a=t>>r-6&63;e.push(Er[a]),r-=6}}),r>0)for(t=t<<6-r,r=6;r>=6;){const i=t>>r-6&63;e.push(Er[i]),r-=6}return e.join("")}function Cs(s){const e=[],t=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0};let n=0,i=0;for(let a=0;a<s.length;a+=1){const o=s.charCodeAt(a),l=lo[o];if(l>-1)for(n=n<<6|l,i+=6;i>=8;)ho(n>>i-8&255,r,t),i-=8;else{if(l===-2)continue;throw new Error(`Invalid Base64-URL character "${s.at(a)}" at position ${a}`)}}return e.join("")}function co(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function uo(s,e){for(let t=0;t<s.length;t+=1){let r=s.charCodeAt(t);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(s.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}co(r,e)}}function ho(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let r=1;r<6;r+=1)if(!(s>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}const Mt="base64-";function un(s,e){const t=s.cookies??null,r=s.cookieEncoding,n={},i={};let a,o;if(t)if("get"in t){const l=async u=>{const c=u.flatMap(h=>[h,...Array.from({length:5}).map((g,p)=>`${h}.${p}`)]),d=[];for(let h=0;h<c.length;h+=1){const g=await t.get(c[h]);!g&&typeof g!="string"||d.push({name:c[h],value:g})}return d};if(a=async u=>await l(u),"set"in t&&"remove"in t)o=async u=>{for(let c=0;c<u.length;c+=1){const{name:d,value:h,options:g}=u[c];h?await t.set(d,h,g):await t.remove(d,g)}};else if(e)o=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw new Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in t)if(a=async()=>await t.getAll(),"setAll"in t)o=t.setAll;else if(e)o=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw new Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw new Error(`@supabase/ssr: ${e?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${Ft()?" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.":""}`);else if(!e&&Ft()){const l=()=>{const u=Wa(document.cookie);return Object.keys(u).map(c=>({name:c,value:u[c]}))};a=()=>l(),o=u=>{u.forEach(({name:c,value:d,options:h})=>{document.cookie=Ja(c,d,h)})}}else{if(e)throw new Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");a=()=>[],o=()=>{throw new Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")}}return e?{getAll:a,setAll:o,setItems:n,removedItems:i,storage:{isServer:!0,getItem:async l=>{if(typeof n[l]=="string")return n[l];if(i[l])return null;const u=await a([l]),c=await As(l,async h=>{const g=(u==null?void 0:u.find(({name:p})=>p===h))||null;return g?g.value:null});if(!c)return null;let d=c;return typeof c=="string"&&c.startsWith(Mt)&&(d=Cs(c.substring(Mt.length))),d},setItem:async(l,u)=>{l.endsWith("-code-verifier")&&await dn({getAll:a,setAll:o,setItems:{[l]:u},removedItems:{}},{cookieOptions:(s==null?void 0:s.cookieOptions)??null,cookieEncoding:r}),n[l]=u,delete i[l]},removeItem:async l=>{delete n[l],i[l]=!0}}}:{getAll:a,setAll:o,setItems:n,removedItems:i,storage:{isServer:!1,getItem:async l=>{const u=await a([l]),c=await As(l,async h=>{const g=(u==null?void 0:u.find(({name:p})=>p===h))||null;return g?g.value:null});if(!c)return null;let d=c;return c.startsWith(Mt)&&(d=Cs(c.substring(Mt.length))),d},setItem:async(l,u)=>{const c=await a([l]),d=(c==null?void 0:c.map(({name:C})=>C))||[],h=new Set(d.filter(C=>kr(C,l)));let g=u;r==="base64url"&&(g=Mt+cn(u));const p=ln(l,g);p.forEach(({name:C})=>{h.delete(C)});const b={...St,...s==null?void 0:s.cookieOptions,maxAge:0},v={...St,...s==null?void 0:s.cookieOptions,maxAge:St.maxAge};delete b.name,delete v.name;const P=[...[...h].map(C=>({name:C,value:"",options:b})),...p.map(({name:C,value:A})=>({name:C,value:A,options:v}))];P.length>0&&await o(P)},removeItem:async l=>{const u=await a([l]),d=((u==null?void 0:u.map(({name:g})=>g))||[]).filter(g=>kr(g,l)),h={...St,...s==null?void 0:s.cookieOptions,maxAge:0};delete h.name,d.length>0&&await o(d.map(g=>({name:g,value:"",options:h})))}}}}async function dn({getAll:s,setAll:e,setItems:t,removedItems:r},n){const i=n.cookieEncoding,a=n.cookieOptions??null,o=await s([...t?Object.keys(t):[],...r?Object.keys(r):[]]),l=(o==null?void 0:o.map(({name:g})=>g))||[],u=Object.keys(r).flatMap(g=>l.filter(p=>kr(p,g))),c=Object.keys(t).flatMap(g=>{const p=new Set(l.filter(P=>kr(P,g)));let b=t[g];i==="base64url"&&(b=Mt+cn(b));const v=ln(g,b);return v.forEach(P=>{p.delete(P.name)}),u.push(...p),v}),d={...St,...a,maxAge:0},h={...St,...a,maxAge:St.maxAge};delete d.name,delete h.name,await e([...u.map(g=>({name:g,value:"",options:d})),...c.map(({name:g,value:p})=>({name:g,value:p,options:h}))])}let Fr;function fo(s,e,t){var a,o;const r=(t==null?void 0:t.isSingleton)===!0||(!t||!("isSingleton"in t))&&Ft();if(r&&Fr)return Fr;const{storage:n}=un({...t,cookieEncoding:(t==null?void 0:t.cookieEncoding)??"base64url"},!1),i=an(s,e,{...t,global:{...t==null?void 0:t.global,headers:{...(a=t==null?void 0:t.global)==null?void 0:a.headers,"X-Client-Info":`supabase-ssr/${on}`}},auth:{...t==null?void 0:t.auth,...(o=t==null?void 0:t.cookieOptions)!=null&&o.name?{storageKey:t.cookieOptions.name}:null,flowType:"pkce",autoRefreshToken:Ft(),detectSessionInUrl:Ft(),persistSession:!0,storage:n}});return r&&(Fr=i),i}function go(s,e,t){var u,c;const{storage:r,getAll:n,setAll:i,setItems:a,removedItems:o}=un({...t,cookieEncoding:(t==null?void 0:t.cookieEncoding)??"base64url"},!0),l=an(s,e,{...t,global:{...t==null?void 0:t.global,headers:{...(u=t==null?void 0:t.global)==null?void 0:u.headers,"X-Client-Info":`supabase-ssr/${on}`}},auth:{...(c=t==null?void 0:t.cookieOptions)!=null&&c.name?{storageKey:t.cookieOptions.name}:null,...t==null?void 0:t.auth,flowType:"pkce",autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!0,storage:r}});return l.auth.onAuthStateChange(async d=>{(Object.keys(a).length>0||Object.keys(o).length>0)&&(d==="SIGNED_IN"||d==="TOKEN_REFRESHED"||d==="USER_UPDATED"||d==="PASSWORD_RECOVERY"||d==="SIGNED_OUT"||d==="MFA_CHALLENGE_VERIFIED")&&await dn({getAll:n,setAll:i,setItems:a,removedItems:o},{cookieOptions:(t==null?void 0:t.cookieOptions)??null,cookieEncoding:(t==null?void 0:t.cookieEncoding)??"base64url"})}),l}const vo=async({data:s,depends:e,fetch:t})=>{e("supabase:auth");const r=Ft()?fo(as,is,{global:{fetch:t}}):go(as,is,{global:{fetch:t},cookies:{getAll(){return s.cookies}}}),{data:{session:n}}=await r.auth.getSession(),{data:{user:i}}=await r.auth.getUser(),{sessionUserId:a,profile:o}=s;return{session:n,sessionUserId:a,profile:o,supabase:r,user:i}},Xl=Object.freeze(Object.defineProperty({__proto__:null,load:vo},Symbol.toStringTag,{value:"Module"})),_o={ltr:[...zr,qe.ARROW_RIGHT]},po={ltr:[qe.ARROW_LEFT]},Is=["menu","trigger"],mo={arrowSize:8,positioning:{placement:"bottom"},preventScroll:!0,closeOnEscape:!0,closeOnOutsideClick:!0,portal:void 0,loop:!1,dir:"ltr",defaultOpen:!1,typeahead:!0,closeOnItemClick:!0,onOutsideClick:void 0};function yo(s){const{name:e,selector:t}=Pn(s.selector),{preventScroll:r,arrowSize:n,positioning:i,closeOnEscape:a,closeOnOutsideClick:o,portal:l,forceVisible:u,typeahead:c,loop:d,closeFocus:h,disableFocusFirstItem:g,closeOnItemClick:p,onOutsideClick:b}=s.rootOptions,v=s.rootOpen,P=s.rootActiveTrigger,C=s.nextFocusable,A=s.prevFocusable,O=je.writable(!1),S=je(Ie(0)),F=je(Ie(null)),G=je(Ie("right")),D=je(Ie(null)),L=je(rr([G,F],([f,m])=>_=>f===(m==null?void 0:m.side)&&wo(_,m==null?void 0:m.area))),{typed:te,handleTypeaheadSearch:X}=xn(),k=nr({...ds(Is),...s.ids}),R=hs({open:v,forceVisible:u,activeTrigger:P}),de=Fe(e(),{stores:[R,l,k.menu,k.trigger],returned:([f,m,_,w])=>({role:"menu",hidden:f?void 0:!0,style:Qt({display:f?void 0:"none"}),id:_,"aria-labelledby":w,"data-state":f?"open":"closed","data-portal":Sn(m),tabindex:-1}),action:f=>{let m=Xt;const _=Qe([R,P,i,o,l,a],([I,_e,Pe,ve,Y,ae])=>{m(),!(!I||!_e)&&hr().then(()=>{m(),tr(f,t),m=fs(f,{anchorElement:_e,open:v,options:{floating:Pe,modal:{closeOnInteractOutside:ve,shouldCloseOnInteractOutside:W=>{var Z;return(Z=b.get())==null||Z(W),!(W.defaultPrevented||B(_e)&&_e.contains(W.target))},onClose:()=>{v.set(!1),_e.focus()},open:I},portal:gs(f,Y),escapeKeydown:ae?void 0:null}}).destroy})}),w=tt(le(f,"keydown",I=>{const _e=I.target,Pe=I.currentTarget;if(!B(_e)||!B(Pe)||!(_e.closest('[role="menu"]')===Pe))return;if(cs.includes(I.key)&&Rs(I,d.get()??!1),I.key===qe.TAB){I.preventDefault(),v.set(!1),js(I,C,A);return}const Y=I.key.length===1;!(I.ctrlKey||I.altKey||I.metaKey)&&Y&&c.get()===!0&&X(I.key,wt(Pe))}));return{destroy(){_(),w(),m()}}}}),q=Fe(e("trigger"),{stores:[v,k.menu,k.trigger],returned:([f,m,_])=>({"aria-controls":m,"aria-expanded":f,"data-state":f?"open":"closed",id:_,tabindex:0}),action:f=>(pr(f),P.update(_=>_||f),{destroy:tt(le(f,"click",_=>{const w=v.get(),I=_.currentTarget;B(I)&&(De(I),w||_.preventDefault())}),le(f,"keydown",_=>{const w=_.currentTarget;if(!B(w)||!(zr.includes(_.key)||_.key===qe.ARROW_DOWN))return;_.preventDefault(),De(w);const I=w.getAttribute("aria-controls");if(!I)return;const _e=document.getElementById(I);if(!_e)return;const Pe=wt(_e);Pe.length&&Ce(Pe[0])}))})}),U=Fe(e("arrow"),{stores:n,returned:f=>({"data-arrow":!0,style:Qt({position:"absolute",width:`var(--arrow-size, ${f}px)`,height:`var(--arrow-size, ${f}px)`})})}),Q=Fe(e("overlay"),{stores:[R],returned:([f])=>({hidden:f?void 0:!0,tabindex:-1,style:Qt({display:f?void 0:"none"}),"aria-hidden":"true","data-state":Eo(f)}),action:f=>{let m=Xt;if(a.get()){const w=$n(f,{handler:()=>{v.set(!1);const I=P.get();I&&I.focus()}});w&&w.destroy&&(m=w.destroy)}const _=Qe([l],([w])=>{if(w===null)return Xt;const I=gs(f,w);return I===null?Xt:Dn(f,I).destroy});return{destroy(){m(),_()}}}}),he=Fe(e("item"),{returned:()=>({role:"menuitem",tabindex:-1,"data-orientation":"vertical"}),action:f=>(tr(f,t),pr(f),{destroy:tt(le(f,"pointerdown",_=>{const w=_.currentTarget;if(B(w)&&rt(w)){_.preventDefault();return}}),le(f,"click",_=>{const w=_.currentTarget;if(B(w)){if(rt(w)){_.preventDefault();return}if(_.defaultPrevented){Ce(w);return}p.get()&&Nt(1).then(()=>{v.set(!1)})}}),le(f,"keydown",_=>{Se(_)}),le(f,"pointermove",_=>{_t(_)}),le(f,"pointerleave",_=>{Ue(_)}),le(f,"focusin",_=>{ye(_)}),le(f,"focusout",_=>{at(_)}))})}),re=Fe(e("group"),{returned:()=>f=>({role:"group","aria-labelledby":f})}),ie=Fe(e("group-label"),{returned:()=>f=>({id:f})}),we={defaultChecked:!1,disabled:!1},M=f=>{const m={...we,...f},_=m.checked??Ie(m.defaultChecked??null),w=mr(_,m.onCheckedChange),I=Ie(m.disabled),_e=Fe(e("checkbox-item"),{stores:[w,I],returned:([Y,ae])=>({role:"menuitemcheckbox",tabindex:-1,"data-orientation":"vertical","aria-checked":Ve(Y)?"mixed":Y?"true":"false","data-disabled":Dr(ae),"data-state":Gt(Y)}),action:Y=>(tr(Y,t),pr(Y),{destroy:tt(le(Y,"pointerdown",W=>{const Z=W.currentTarget;if(B(Z)&&rt(Z)){W.preventDefault();return}}),le(Y,"click",W=>{const Z=W.currentTarget;if(B(Z)){if(rt(Z)){W.preventDefault();return}if(W.defaultPrevented){Ce(Z);return}w.update(ot=>Ve(ot)?!0:!ot),p.get()&&hr().then(()=>{v.set(!1)})}}),le(Y,"keydown",W=>{Se(W)}),le(Y,"pointermove",W=>{const Z=W.currentTarget;if(B(Z)){if(rt(Z)){Le(W);return}_t(W,Z)}}),le(Y,"pointerleave",W=>{Ue(W)}),le(Y,"focusin",W=>{ye(W)}),le(Y,"focusout",W=>{at(W)}))})}),Pe=rr(w,Y=>Y===!0),ve=rr(w,Y=>Y==="indeterminate");return{elements:{checkboxItem:_e},states:{checked:w},helpers:{isChecked:Pe,isIndeterminate:ve},options:{disabled:I}}},x=(f={})=>{const m=f.value??Ie(f.defaultValue??null),_=mr(m,f.onValueChange),w=Fe(e("radio-group"),{returned:()=>({role:"group"})}),I={disabled:!1},_e=Fe(e("radio-item"),{stores:[_],returned:([ve])=>Y=>{const{value:ae,disabled:W}={...I,...Y},Z=ve===ae;return{disabled:W,role:"menuitemradio","data-state":Z?"checked":"unchecked","aria-checked":Z,"data-disabled":Dr(W),"data-value":ae,"data-orientation":"vertical",tabindex:-1}},action:ve=>(tr(ve,t),{destroy:tt(le(ve,"pointerdown",ae=>{const W=ae.currentTarget;if(!B(W))return;const Z=ve.dataset.value;if(ve.dataset.disabled||Z===void 0){ae.preventDefault();return}}),le(ve,"click",ae=>{const W=ae.currentTarget;if(!B(W))return;const Z=ve.dataset.value;if(ve.dataset.disabled||Z===void 0){ae.preventDefault();return}if(ae.defaultPrevented){if(!B(W))return;Ce(W);return}_.set(Z),p.get()&&hr().then(()=>{v.set(!1)})}),le(ve,"keydown",ae=>{Se(ae)}),le(ve,"pointermove",ae=>{const W=ae.currentTarget;if(!B(W))return;const Z=ve.dataset.value;if(ve.dataset.disabled||Z===void 0){Le(ae);return}_t(ae,W)}),le(ve,"pointerleave",ae=>{Ue(ae)}),le(ve,"focusin",ae=>{ye(ae)}),le(ve,"focusout",ae=>{at(ae)}))})}),Pe=rr(_,ve=>Y=>ve===Y);return{elements:{radioGroup:w,radioItem:_e},states:{value:_},helpers:{isChecked:Pe}}},{elements:{root:N}}=Po({orientation:"horizontal"}),ge={...mo,disabled:!1,positioning:{placement:"right-start",gutter:8}},V=f=>{const m={...ge,...f},_=m.open??Ie(!1),w=mr(_,m==null?void 0:m.onOpenChange),I=nr(Ds(m,"ids")),{positioning:_e,arrowSize:Pe,disabled:ve}=I,Y=je(Ie(null)),ae=je(Ie(null)),W=je(Ie(0)),Z=nr({...ds(Is),...m.ids});us(()=>{const ne=document.getElementById(Z.trigger.get());ne&&Y.set(ne)});const ot=hs({open:w,forceVisible:u,activeTrigger:Y}),fn=Fe(e("submenu"),{stores:[ot,Z.menu,Z.trigger],returned:([ne,Te,Ne])=>({role:"menu",hidden:ne?void 0:!0,style:Qt({display:ne?void 0:"none"}),id:Te,"aria-labelledby":Ne,"data-state":ne?"open":"closed","data-id":Te,tabindex:-1}),action:ne=>{let Te=Xt;const Ne=Qe([ot,_e],([j,fe])=>{if(Te(),!j)return;const be=Y.get();be&&hr().then(()=>{Te();const Ee=xe(be);Te=fs(ne,{anchorElement:be,open:w,options:{floating:fe,portal:B(Ee)?Ee:void 0,modal:null,focusTrap:null,escapeKeydown:null}}).destroy})}),oe=tt(le(ne,"keydown",j=>{if(j.key===qe.ESCAPE)return;const fe=j.target,be=j.currentTarget;if(!B(fe)||!B(be)||!(fe.closest('[role="menu"]')===be))return;if(cs.includes(j.key)){j.stopImmediatePropagation(),Rs(j,d.get()??!1);return}const xt=po.ltr.includes(j.key),Ct=j.ctrlKey||j.altKey||j.metaKey,dr=j.key.length===1;if(xt){const ns=Y.get();j.preventDefault(),w.update(()=>(ns&&Ce(ns),!1));return}if(j.key===qe.TAB){j.preventDefault(),v.set(!1),js(j,C,A);return}!Ct&&dr&&c.get()===!0&&X(j.key,wt(be))}),le(ne,"pointermove",j=>{et(j)}),le(ne,"focusout",j=>{const fe=Y.get();if(O.get()){const be=j.target,Ee=document.getElementById(Z.menu.get());if(!B(Ee)||!B(be))return;!Ee.contains(be)&&be!==fe&&w.set(!1)}else{const be=j.currentTarget,Ee=j.relatedTarget;if(!B(Ee)||!B(be))return;!be.contains(Ee)&&Ee!==fe&&w.set(!1)}}));return{destroy(){Ne(),Te(),oe()}}}}),gn=Fe(e("subtrigger"),{stores:[w,ve,Z.menu,Z.trigger],returned:([ne,Te,Ne,oe])=>({role:"menuitem",id:oe,tabindex:-1,"aria-controls":Ne,"aria-expanded":ne,"data-state":ne?"open":"closed","data-disabled":Dr(Te),"aria-haspopop":"menu"}),action:ne=>{tr(ne,t),pr(ne),Y.update(oe=>oe||ne);const Te=()=>{qr(ae),window.clearTimeout(W.get()),F.set(null)},Ne=tt(le(ne,"click",oe=>{if(oe.defaultPrevented)return;const j=oe.currentTarget;!B(j)||rt(j)||(Ce(j),w.get()||w.update(fe=>fe||(Y.set(j),!fe)))}),le(ne,"keydown",oe=>{const j=te.get(),fe=oe.currentTarget;if(!(!B(fe)||rt(fe)||j.length>0&&oe.key===qe.SPACE)&&_o.ltr.includes(oe.key)){if(!w.get()){fe.click(),oe.preventDefault();return}const Ee=fe.getAttribute("aria-controls");if(!Ee)return;const xt=document.getElementById(Ee);if(!B(xt))return;const Ct=wt(xt)[0];Ce(Ct)}}),le(ne,"pointermove",oe=>{if(!er(oe)||(At(oe),oe.defaultPrevented))return;const j=oe.currentTarget;if(!B(j))return;ko(Z.menu.get())||Ce(j);const fe=ae.get();!w.get()&&!fe&&!rt(j)&&ae.set(window.setTimeout(()=>{w.update(()=>(Y.set(j),!0)),qr(ae)},100))}),le(ne,"pointerleave",oe=>{if(!er(oe))return;qr(ae);const j=document.getElementById(Z.menu.get()),fe=j==null?void 0:j.getBoundingClientRect();if(fe){const be=j==null?void 0:j.dataset.side,Ee=be==="right",xt=Ee?-5:5,Ct=fe[Ee?"left":"right"],dr=fe[Ee?"right":"left"];F.set({area:[{x:oe.clientX+xt,y:oe.clientY},{x:Ct,y:fe.top},{x:dr,y:fe.top},{x:dr,y:fe.bottom},{x:Ct,y:fe.bottom}],side:be}),window.clearTimeout(W.get()),W.set(window.setTimeout(()=>{F.set(null)},300))}else{if(Ae(oe),oe.defaultPrevented)return;F.set(null)}}),le(ne,"focusout",oe=>{const j=oe.currentTarget;if(!B(j))return;It(j);const fe=oe.relatedTarget;if(!B(fe))return;const be=j.getAttribute("aria-controls");if(!be)return;const Ee=document.getElementById(be);Ee&&!Ee.contains(fe)&&w.set(!1)}),le(ne,"focusin",oe=>{ye(oe)}));return{destroy(){Te(),Ne()}}}}),vn=Fe(e("subarrow"),{stores:Pe,returned:ne=>({"data-arrow":!0,style:Qt({position:"absolute",width:`var(--arrow-size, ${ne}px)`,height:`var(--arrow-size, ${ne}px)`})})});return Qe([v],([ne])=>{ne||(Y.set(null),w.set(!1))}),Qe([F],([ne])=>{!Lt||ne||window.clearTimeout(W.get())}),Qe([w],([ne])=>{if(Lt&&(ne&&O.get()&&Nt(1).then(()=>{const Te=document.getElementById(Z.menu.get());if(!Te)return;const Ne=wt(Te);Ne.length&&Ce(Ne[0])}),!ne)){const Te=D.get(),Ne=document.getElementById(Z.trigger.get());if(Te&&Nt(1).then(()=>{const oe=document.getElementById(Z.menu.get());oe&&oe.contains(Te)&&It(Te)}),!Ne||document.activeElement===Ne)return;It(Ne)}}),{ids:Z,elements:{subTrigger:gn,subMenu:fn,subArrow:vn},states:{subOpen:w},options:I}};us(()=>{const f=document.getElementById(k.trigger.get());B(f)&&v.get()&&P.set(f);const m=[],_=()=>O.set(!1),w=()=>{O.set(!0),m.push(tt(pt(document,"pointerdown",_,{capture:!0,once:!0}),pt(document,"pointermove",_,{capture:!0,once:!0})))},I=_e=>{if(_e.key===qe.ESCAPE&&a.get()){v.set(!1);return}};return m.push(pt(document,"keydown",w,{capture:!0})),m.push(pt(document,"keydown",I)),()=>{m.forEach(_e=>_e())}}),Qe([v,D],([f,m])=>{!f&&m&&It(m)}),Qe([v],([f])=>{if(Lt&&!f){const m=P.get();if(!m)return;const _=h.get();!f&&m&&qn({prop:_,defaultEl:m})}}),Qe([v,r],([f,m])=>{if(!Lt)return;const _=[];return f&&m&&_.push(Ln()),Nt(1).then(()=>{const w=document.getElementById(k.menu.get());if(w&&f&&O.get()){if(g.get()){Ce(w);return}const I=wt(w);if(!I.length)return;Ce(I[0])}}),()=>{_.forEach(w=>w())}}),Qe(v,f=>{if(!Lt)return;const m=()=>O.set(!1),_=w=>{if(O.set(!0),w.key===qe.ESCAPE&&f&&a.get()){v.set(!1);return}};return tt(pt(document,"pointerdown",m,{capture:!0,once:!0}),pt(document,"pointermove",m,{capture:!0,once:!0}),pt(document,"keydown",_,{capture:!0}))});function De(f){v.update(m=>{const _=!m;return _&&(C.set(Cn(f)),A.set(In(f)),P.set(f)),_})}function ye(f){const m=f.currentTarget;if(!B(m))return;const _=D.get();_&&It(_),jn(m),D.set(m)}function at(f){const m=f.currentTarget;B(m)&&It(m)}function At(f){Me(f)&&f.preventDefault()}function Le(f){if(Me(f))return;const m=f.target;if(!B(m))return;const _=xe(m);_&&Ce(_)}function Ae(f){Me(f)&&f.preventDefault()}function et(f){if(!er(f))return;const m=f.target,_=f.currentTarget;if(!B(_)||!B(m))return;const w=S.get(),I=w!==f.clientX;if(_.contains(m)&&I){const _e=f.clientX>w?"right":"left";G.set(_e),S.set(f.clientX)}}function _t(f,m=null){if(!er(f)||(At(f),f.defaultPrevented))return;if(m){Ce(m);return}const _=f.currentTarget;B(_)&&Ce(_)}function Ue(f){er(f)&&Le(f)}function Se(f){if(te.get().length>0&&f.key===qe.SPACE){f.preventDefault();return}if(zr.includes(f.key)){f.preventDefault();const w=f.currentTarget;if(!B(w))return;w.click()}}function Ve(f){return f==="indeterminate"}function Gt(f){return Ve(f)?"indeterminate":f?"checked":"unchecked"}function Me(f){return L.get()(f)}function xe(f){const m=f.closest('[role="menu"]');return B(m)?m:null}return{elements:{trigger:q,menu:de,overlay:Q,item:he,group:re,groupLabel:ie,arrow:U,separator:N},builders:{createCheckboxItem:M,createSubmenu:V,createMenuRadioGroup:x},states:{open:v},helpers:{handleTypeaheadSearch:X},ids:k,options:s.rootOptions}}function js(s,e,t){if(s.shiftKey){const r=t.get();r&&(s.preventDefault(),Nt(1).then(()=>r.focus()),t.set(null))}else{const r=e.get();r&&(s.preventDefault(),Nt(1).then(()=>r.focus()),e.set(null))}}function wt(s){return Array.from(s.querySelectorAll(`[data-melt-menu-id="${s.id}"]`)).filter(e=>B(e))}function pr(s){!s||!rt(s)||(s.setAttribute("data-disabled",""),s.setAttribute("aria-disabled","true"))}function qr(s){if(!Lt)return;const e=s.get();e&&(window.clearTimeout(e),s.set(null))}function er(s){return s.pointerType==="mouse"}function tr(s,e){if(!s)return;const t=s.closest(`${e()}, ${e("submenu")}`);B(t)&&s.setAttribute("data-melt-menu-id",t.id)}function Rs(s,e){s.preventDefault();const t=document.activeElement,r=s.currentTarget;if(!B(t)||!B(r))return;const n=wt(r);if(!n.length)return;const i=n.filter(l=>!(l.hasAttribute("data-disabled")||l.getAttribute("disabled")==="true")),a=i.indexOf(t);let o;switch(s.key){case qe.ARROW_DOWN:e?o=a<i.length-1?a+1:0:o=a<i.length-1?a+1:a;break;case qe.ARROW_UP:e?o=a>0?a-1:i.length-1:o=a<0?i.length-1:a>0?a-1:0;break;case qe.HOME:o=0;break;case qe.END:o=i.length-1;break;default:return}Ce(i[o])}function wo(s,e){if(!e)return!1;const t={x:s.clientX,y:s.clientY};return bo(t,e)}function bo(s,e){const{x:t,y:r}=s;let n=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const o=e[i].x,l=e[i].y,u=e[a].x,c=e[a].y;l>r!=c>r&&t<(u-o)*(r-l)/(c-l)+o&&(n=!n)}return n}function ko(s){const e=document.activeElement;if(!B(e))return!1;const t=e.closest(`[data-id="${s}"]`);return B(t)}function Eo(s){return s?"open":"closed"}const To={arrowSize:8,positioning:{placement:"bottom"},preventScroll:!0,closeOnEscape:!0,closeOnOutsideClick:!0,portal:void 0,loop:!1,dir:"ltr",defaultOpen:!1,forceVisible:!1,typeahead:!0,closeFocus:void 0,disableFocusFirstItem:!1,closeOnItemClick:!0,onOutsideClick:void 0};function Oo(s){const e={...To,...s},t=nr(Ds(e,"ids")),r=e.open??Ie(e.defaultOpen),n=mr(r,e==null?void 0:e.onOpenChange),i=je(Ie(null)),a=je(Ie(null)),o=je(Ie(null)),{elements:l,builders:u,ids:c,states:d,options:h}=yo({rootOptions:t,rootOpen:n,rootActiveTrigger:je(i),nextFocusable:je(a),prevFocusable:je(o),selector:"dropdown-menu",ids:e.ids});return{ids:c,elements:l,states:d,builders:u,options:h}}const So={orientation:"horizontal",decorative:!1},Po=s=>{const e={...So,...s},t=nr(e),{orientation:r,decorative:n}=t;return{elements:{root:Fe("separator",{stores:[r,n],returned:([a,o])=>({role:o?"none":"separator","aria-orientation":a==="vertical"?a:void 0,"aria-hidden":o,"data-orientation":a})})},options:t}};function hn(){return{NAME:"menu",SUB_NAME:"menu-submenu",RADIO_GROUP_NAME:"menu-radiogroup",CHECKBOX_ITEM_NAME:"menu-checkboxitem",RADIO_ITEM_NAME:"menu-radioitem",GROUP_NAME:"menu-group",PARTS:["arrow","checkbox-indicator","checkbox-item","content","group","item","label","radio-group","radio-item","radio-indicator","separator","sub-content","sub-trigger","trigger"]}}function Rr(){const{NAME:s}=hn();return pn(s)}function $o(s){const{NAME:e,PARTS:t}=hn(),r=Mn("menu",t),n={...Oo({...Nn(s),forceVisible:!0}),getAttrs:r};return mn(e,n),{...n,updateOption:Bn(n.options)}}function Ao(s){const t={...{side:"bottom",align:"center"},...s},{options:{positioning:r}}=Rr();Un(r)(t)}function ue(s,e){const t=zt(e,["children","$$slots","$$events","$$legacy"]),r=zt(t,["href","asChild","disabled","el"]);Ht(e,!1);const[n,i]=Sr(),a=()=>or(g,"$item",n),o=wr(),l=wr();let u=H(e,"href",24,()=>{}),c=H(e,"asChild",8,!1),d=H(e,"disabled",8,!1),h=H(e,"el",28,()=>{});const{elements:{item:g},getAttrs:p}=Rr(),b=Yr();ke(()=>a(),()=>{yr(o,a())}),ke(()=>me(d()),()=>{yr(l,{...p("item"),...Fn(d())})}),ke(()=>(T(o),T(l)),()=>{Object.assign(T(o),T(l))}),Tr(),Or();var v=it(),P=J(v);{var C=O=>{var S=it(),F=J(S);Je(F,e,"default",{get builder(){return T(o)}},null),y(O,S)},A=O=>{var S=it(),F=J(S);An(F,()=>u()?"a":"div",!1,(G,D)=>{Tt(G,k=>h(k),()=>h()),Et(G,k=>{var R,de;return(de=(R=T(o)).action)==null?void 0:de.call(R,k)});let L;nt(()=>L=kt(G,L,{href:u(),...T(o),...r},void 0,G.namespaceURI===yn,G.nodeName.includes("-"))),Re("m-click",G,b),Re("m-focusin",G,b),Re("m-focusout",G,b),Re("m-keydown",G,b),Re("m-pointerdown",G,b),Re("m-pointerleave",G,b),Re("m-pointermove",G,b),Re("pointerenter",G,function(k){Rn.call(this,e,k)});var te=it(),X=J(te);Je(X,e,"default",{get builder(){return T(o)}},null),y(D,te)}),y(O,S)};Ze(P,O=>{c()?O(C):O(A,!1)})}y(s,v),Vt(),i()}function ct(s,e){Ht(e,!1);const[t,r]=Sr(),n=()=>or(S,"$idValues",t);let i=H(e,"closeOnOutsideClick",24,()=>{}),a=H(e,"closeOnEscape",24,()=>{}),o=H(e,"portal",24,()=>{}),l=H(e,"open",28,()=>{}),u=H(e,"onOpenChange",24,()=>{}),c=H(e,"preventScroll",24,()=>{}),d=H(e,"loop",24,()=>{}),h=H(e,"dir",24,()=>{}),g=H(e,"typeahead",24,()=>{}),p=H(e,"closeFocus",24,()=>{}),b=H(e,"disableFocusFirstItem",24,()=>{}),v=H(e,"closeOnItemClick",24,()=>{}),P=H(e,"onOutsideClick",24,()=>{});const{states:{open:C},updateOption:A,ids:O}=$o({closeOnOutsideClick:i(),closeOnEscape:a(),portal:o(),forceVisible:!0,defaultOpen:l(),preventScroll:c(),loop:d(),dir:h(),typeahead:g(),closeFocus:p(),disableFocusFirstItem:b(),closeOnItemClick:v(),onOutsideClick:P(),onOpenChange:({next:D})=>{var L;return l()!==D&&((L=u())==null||L(D),l(D)),D}}),S=rr([O.menu,O.trigger],([D,L])=>({menu:D,trigger:L}));ke(()=>me(l()),()=>{l()!==void 0&&C.set(l())}),ke(()=>me(i()),()=>{A("closeOnOutsideClick",i())}),ke(()=>me(a()),()=>{A("closeOnEscape",a())}),ke(()=>me(o()),()=>{A("portal",o())}),ke(()=>me(c()),()=>{A("preventScroll",c())}),ke(()=>me(d()),()=>{A("loop",d())}),ke(()=>me(h()),()=>{A("dir",h())}),ke(()=>me(p()),()=>{A("closeFocus",p())}),ke(()=>me(b()),()=>{A("disableFocusFirstItem",b())}),ke(()=>me(g()),()=>{A("typeahead",g())}),ke(()=>me(v()),()=>{A("closeOnItemClick",v())}),ke(()=>me(P()),()=>{A("onOutsideClick",P())}),Tr(),Or();var F=it(),G=J(F);Je(G,e,"default",{get ids(){return n()}},null),y(s,F),Vt(),r()}var xo=ee("<div><!></div>"),Co=ee("<div><!></div>"),Io=ee("<div><!></div>"),jo=ee("<div><!></div>"),Ro=ee("<div><!></div>");function ut(s,e){const t=zt(e,["children","$$slots","$$events","$$legacy"]),r=zt(t,["transition","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","side","align","sideOffset","alignOffset","collisionPadding","avoidCollisions","collisionBoundary","sameWidth","fitViewport","strategy","overlap","el"]);Ht(e,!1);const[n,i]=Sr(),a=()=>or(R,"$menu",n),o=()=>or(de,"$open",n),l=wr();let u=H(e,"transition",24,()=>{}),c=H(e,"transitionConfig",24,()=>{}),d=H(e,"inTransition",24,()=>{}),h=H(e,"inTransitionConfig",24,()=>{}),g=H(e,"outTransition",24,()=>{}),p=H(e,"outTransitionConfig",24,()=>{}),b=H(e,"asChild",8,!1),v=H(e,"id",24,()=>{}),P=H(e,"side",8,"bottom"),C=H(e,"align",8,"center"),A=H(e,"sideOffset",8,0),O=H(e,"alignOffset",8,0),S=H(e,"collisionPadding",8,8),F=H(e,"avoidCollisions",8,!0),G=H(e,"collisionBoundary",24,()=>{}),D=H(e,"sameWidth",8,!1),L=H(e,"fitViewport",8,!1),te=H(e,"strategy",8,"absolute"),X=H(e,"overlap",8,!1),k=H(e,"el",28,()=>{});const{elements:{menu:R},states:{open:de},ids:q,getAttrs:U}=Rr(),Q=Yr(),he=U("content");ke(()=>me(v()),()=>{v()&&q.menu.set(v())}),ke(()=>a(),()=>{yr(l,a())}),ke(()=>T(l),()=>{Object.assign(T(l),he)}),ke(()=>(o(),me(P()),me(C()),me(A()),me(O()),me(S()),me(F()),me(G()),me(D()),me(L()),me(te()),me(X())),()=>{o()&&Ao({side:P(),align:C(),sideOffset:A(),alignOffset:O(),collisionPadding:S(),avoidCollisions:F(),collisionBoundary:G(),sameWidth:D(),fitViewport:L(),strategy:te(),overlap:X()})}),Tr(),Or();var re=it(),ie=J(re);{var we=x=>{var N=it(),ge=J(N);Je(ge,e,"default",{get builder(){return T(l)}},null),y(x,N)},M=(x,N)=>{{var ge=De=>{var ye=xo();let at;var At=Ge(ye);Je(At,e,"default",{get builder(){return T(l)}},null),Xe(ye),Tt(ye,Le=>k(Le),()=>k()),Et(ye,Le=>{var Ae,et;return(et=(Ae=T(l)).action)==null?void 0:et.call(Ae,Le)}),bt(()=>Re("m-keydown",ye,Q)),nt(()=>at=kt(ye,at,{...T(l),...r})),Yt(3,ye,u,c),y(De,ye)},V=(De,ye)=>{{var at=Le=>{var Ae=Co();let et;var _t=Ge(Ae);Je(_t,e,"default",{get builder(){return T(l)}},null),Xe(Ae),Tt(Ae,Ue=>k(Ue),()=>k()),Et(Ae,Ue=>{var Se,Ve;return(Ve=(Se=T(l)).action)==null?void 0:Ve.call(Se,Ue)}),bt(()=>Re("m-keydown",Ae,Q)),nt(()=>et=kt(Ae,et,{...T(l),...r})),Yt(1,Ae,d,h),Yt(2,Ae,g,p),y(Le,Ae)},At=(Le,Ae)=>{{var et=Ue=>{var Se=Io();let Ve;var Gt=Ge(Se);Je(Gt,e,"default",{get builder(){return T(l)}},null),Xe(Se),Tt(Se,Me=>k(Me),()=>k()),Et(Se,Me=>{var xe,f;return(f=(xe=T(l)).action)==null?void 0:f.call(xe,Me)}),bt(()=>Re("m-keydown",Se,Q)),nt(()=>Ve=kt(Se,Ve,{...T(l),...r})),Yt(1,Se,d,h),y(Ue,Se)},_t=(Ue,Se)=>{{var Ve=Me=>{var xe=jo();let f;var m=Ge(xe);Je(m,e,"default",{get builder(){return T(l)}},null),Xe(xe),Tt(xe,_=>k(_),()=>k()),Et(xe,_=>{var w,I;return(I=(w=T(l)).action)==null?void 0:I.call(w,_)}),bt(()=>Re("m-keydown",xe,Q)),nt(()=>f=kt(xe,f,{...T(l),...r})),Yt(2,xe,g,p),y(Me,xe)},Gt=(Me,xe)=>{{var f=m=>{var _=Ro();let w;var I=Ge(_);Je(I,e,"default",{get builder(){return T(l)}},null),Xe(_),Tt(_,_e=>k(_e),()=>k()),Et(_,_e=>{var Pe,ve;return(ve=(Pe=T(l)).action)==null?void 0:ve.call(Pe,_e)}),bt(()=>Re("m-keydown",_,Q)),nt(()=>w=kt(_,w,{...T(l),...r})),y(m,_)};Ze(Me,m=>{o()&&m(f)},xe)}};Ze(Ue,Me=>{g()&&o()?Me(Ve):Me(Gt,!1)},Se)}};Ze(Le,Ue=>{d()&&o()?Ue(et):Ue(_t,!1)},Ae)}};Ze(De,Le=>{d()&&g()&&o()?Le(at):Le(At,!1)},ye)}};Ze(x,De=>{u()&&o()?De(ge):De(V,!1)},N)}};Ze(ie,x=>{b()&&o()?x(we):x(M,!1)})}y(s,re),Vt(),i()}var Do=ee("<button><!></button>");function dt(s,e){const t=zt(e,["children","$$slots","$$events","$$legacy"]),r=zt(t,["asChild","id","el"]);Ht(e,!1);const[n,i]=Sr(),a=()=>or(d,"$trigger",n),o=wr();let l=H(e,"asChild",8,!1),u=H(e,"id",24,()=>{}),c=H(e,"el",28,()=>{});const{elements:{trigger:d},ids:h,getAttrs:g}=Rr(),p=Yr(),b=g("trigger");ke(()=>me(u()),()=>{u()&&h.trigger.set(u())}),ke(()=>a(),()=>{yr(o,a())}),ke(()=>T(o),()=>{Object.assign(T(o),b)}),Tr(),Or();var v=it(),P=J(v);{var C=O=>{var S=it(),F=J(S);Je(F,e,"default",{get builder(){return T(o)}},null),y(O,S)},A=O=>{var S=Do();let F;var G=Ge(S);Je(G,e,"default",{get builder(){return T(o)}},null),Xe(S),Tt(S,D=>c(D),()=>c()),Et(S,D=>{var L,te;return(te=(L=T(o)).action)==null?void 0:te.call(L,D)}),bt(()=>Re("m-keydown",S,p)),bt(()=>Re("m-pointerdown",S,p)),nt(()=>F=kt(S,F,{...T(o),type:"button",...r})),y(O,S)};Ze(P,O=>{l()?O(C):O(A,!1)})}y(s,v),Vt(),i()}const Lo="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2027.5.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20577.43%20205.9'%20style='enable-background:new%200%200%20577.43%20205.9;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%230E1116;}%20.st1{fill:%23F8F8EF;}%20.st2{fill:%238E27FC;}%20.st3{fill:%234D5762;}%20%3c/style%3e%3cg%20id='Group_674_00000106856769330492338740000005917021583205678009_'%20transform='translate(-26%2017)'%3e%3cg%20id='Rectangle_122-2_00000052069067913817408390000003574703763945306011_'%3e%3crect%20x='26'%20y='-17'%20class='st0'%20width='577.43'%20height='205.9'/%3e%3c/g%3e%3cg%20id='Path_109-2_00000151535872903001963660000010623173054771961533_'%3e%3cpath%20class='st1'%20d='M314.19,125.12h-10.44V46.27l43.63-0.13v9.91h-33.2v17.07h33.17v9.91h-33.17V125.12z'/%3e%3c/g%3e%3cg%20id='Path_110-2_00000061433761645288638310000015100925618916539052_'%3e%3cpath%20class='st1'%20d='M417.81,125.13h-13.76l-19.25-35.24h-4.41l0.13,35.24h-10.61V46.25h40.87v43.64h-12.12L417.81,125.13z%20M399.79,56.03h-19.41v23.95h19.4L399.79,56.03z'/%3e%3c/g%3e%3cg%20id='Path_111-2_00000030482309971263364680000000616370780015642803_'%3e%3cpath%20class='st1'%20d='M479.75,114.39v10.74h-43.63V46.27l43.63-0.13v9.91H446.6v17.07h33.17v9.91H446.6v31.38L479.75,114.39z'/%3e%3c/g%3e%3cg%20id='Path_112-2_00000043430453379556173990000003436790021054259121_'%3e%3cpath%20class='st1'%20d='M535.35,162.83h-10.46v-37.71h-22.57V46.26h43.63v78.87h-10.6V162.83z%20M534.96,114.38V56.03l-22.16,0.14%20v58.19L534.96,114.38z'/%3e%3c/g%3e%3cg%20id='Path_113-2_00000055665928395415542740000006958786296353728423_'%3e%3cpath%20class='st2'%20d='M166.76,136.97l-4.44,0l-10.54-86.59l-10.48,83.46l-4.44,0.02l-10.64-79.06l-10.39,68.2l-4.41,0.07%20l-10.9-58.52l-10.17,38.08l-4.25,0.23c-0.21-0.54-4.49-11.66-6.12-16.36H52.75v-4.48h28.84l2.15,1.62%20c0.39,1.37,2.32,6.53,4.07,11.15l10.94-40.95l4.36,0.17l10.29,55.24l10.75-70.55l4.43,0.04L139,116.2l10.59-84.34l4.44,0.01%20l10.52,86.41l10.5-85.31l4.44-0.02l10.63,81.5l10.39-71.03l4.42-0.06l10.76,61.94l10.29-46.92l4.32-0.2l7.54,23.85h32.43v4.48%20h-34.07l-2.13-1.56l-5.51-17.42l-10.93,49.87l-4.39-0.1L202.9,57.91l-10.7,73.2l-4.43-0.03l-10.44-80.03L166.76,136.97z'/%3e%3c/g%3e%3cg%20id='Rectangle_123-2_00000063605794836392181810000009683233047382840966_'%3e%3cpath%20class='st3'%20d='M578.81,164.28H50.62V7.62h528.19V164.28z%20M55.1,159.81h519.24V12.09H55.1V159.81z'/%3e%3c/g%3e%3cg%20id='Line_1-2_00000123403290828034649920000015690053212963089795_'%3e%3crect%20x='270.02'%20y='10.25'%20class='st3'%20width='4.48'%20height='152.58'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";var Uo=ee("create <!>",1),Mo=ee("<!> <!>",1),No=ee("<!> <!>",1),Bo=ee("discover <!>",1),Fo=ee("<!> <!> <!>",1),qo=ee("<!> <!>",1),zo=ee("about <!>",1),Ko=ee("<!> <!> <!>",1),Ho=ee("<!> <!>",1),Vo=ee("<!> <!>",1),Wo=ee("<!> <!> <!> <!> <!>",1),Jo=ee("<!> <!>",1),Go=ee('<a href="/feed"><button class="nav">feed</button></a> <!> <!> <!> <!>',1),Xo=ee("Explore <!>",1),Qo=ee("<!> <!>",1),Yo=ee("<!> <!>",1),Zo=ee('<!> <a href="/about"><button class="nav">about</button></a> <a href="/welcome"><button class="nav">log in/sign up</button></a>',1),el=ee("explore <!>",1),tl=ee("<!> <!> <!> <!> <!> <!> <!> <!>",1),rl=ee("<!> <!>",1),sl=ee("<!> <!>",1),nl=ee("<!> <!> <!> <!> <!>",1),il=ee("<!> <!>",1),al=ee("<!> <!>",1),ol=ee("Explore <!>",1),ll=ee("<!> <!> <!>",1),cl=ee("<!> <!>",1),ul=ee('<!> <a href="/welcome"><button class="nav">log in/sign up</button></a>',1),dl=ee('<div class="grid-background svelte-149pdip"><header class="svelte-149pdip"><a class="logo" href="/"><img class="logo svelte-149pdip" alt="Freq"></a> <nav class="wide svelte-149pdip"><!></nav> <nav class="narrow svelte-149pdip"><!></nav></header> <div class="buttons-group svelte-149pdip"><a class="report svelte-149pdip" target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLSfKj4FlApgfM-Kc4rYwAxNQslBMS9rk-DdfowMa5qcHlRYhew/viewform?usp=sf_link"><button class="standard">report a bug</button></a> <a class="report svelte-149pdip" target="_blank" href="https://forms.gle/27Q7qg6qLWiFnLHv7"><button class="standard">feedback and requests</button></a></div></div>');function hl(s,e){Ht(e,!0);var t=dl();Tn(p=>{wn.title="Freq"});var r=Ge(t),n=Ge(r),i=Ge(n);On(i,"src",Lo),Xe(n);var a=$(n,2),o=Ge(a);{var l=p=>{var b=Go(),v=$(J(b),2);E(v,()=>ct,(O,S)=>{S(O,{children:(F,G)=>{var D=No(),L=J(D);E(L,()=>dt,(X,k)=>{k(X,{children:(R,de)=>{z();var q=Uo(),U=$(J(q));lt(U,{}),y(R,q)},$$slots:{default:!0}})});var te=$(L,2);E(te,()=>ut,(X,k)=>{k(X,{children:(R,de)=>{var q=Mo(),U=J(q);E(U,()=>ue,(he,re)=>{re(he,{href:"/posts/now-playing/new",children:(ie,we)=>{z();var M=ce("new post");y(ie,M)},$$slots:{default:!0}})});var Q=$(U,2);E(Q,()=>ue,(he,re)=>{re(he,{href:"/collection/new",children:(ie,we)=>{z();var M=ce("new collection");y(ie,M)},$$slots:{default:!0}})}),y(R,q)},$$slots:{default:!0}})}),y(F,D)},$$slots:{default:!0}})});var P=$(v,2);E(P,()=>ct,(O,S)=>{S(O,{children:(F,G)=>{var D=qo(),L=J(D);E(L,()=>dt,(X,k)=>{k(X,{children:(R,de)=>{z();var q=Bo(),U=$(J(q));lt(U,{}),y(R,q)},$$slots:{default:!0}})});var te=$(L,2);E(te,()=>ut,(X,k)=>{k(X,{children:(R,de)=>{var q=Fo(),U=J(q);E(U,()=>ue,(re,ie)=>{ie(re,{href:"/feed/firehose",children:(we,M)=>{z();var x=ce("universal feed");y(we,x)},$$slots:{default:!0}})});var Q=$(U,2);E(Q,()=>ue,(re,ie)=>{ie(re,{href:"/collections",children:(we,M)=>{z();var x=ce("collections");y(we,x)},$$slots:{default:!0}})});var he=$(Q,2);E(he,()=>ue,(re,ie)=>{ie(re,{href:"/users",children:(we,M)=>{z();var x=ce("users");y(we,x)},$$slots:{default:!0}})}),y(R,q)},$$slots:{default:!0}})}),y(F,D)},$$slots:{default:!0}})});var C=$(P,2);E(C,()=>ct,(O,S)=>{S(O,{children:(F,G)=>{var D=Ho(),L=J(D);E(L,()=>dt,(X,k)=>{k(X,{children:(R,de)=>{z();var q=zo(),U=$(J(q));lt(U,{}),y(R,q)},$$slots:{default:!0}})});var te=$(L,2);E(te,()=>ut,(X,k)=>{k(X,{children:(R,de)=>{var q=Ko(),U=J(q);E(U,()=>ue,(re,ie)=>{ie(re,{href:"/about",children:(we,M)=>{z();var x=ce("about");y(we,x)},$$slots:{default:!0}})});var Q=$(U,2);E(Q,()=>ue,(re,ie)=>{ie(re,{href:"/about/updates",children:(we,M)=>{z();var x=ce("updates");y(we,x)},$$slots:{default:!0}})});var he=$(Q,2);E(he,()=>ue,(re,ie)=>{ie(re,{href:"/about/guidelines",children:(we,M)=>{z();var x=ce("community guidlines");y(we,x)},$$slots:{default:!0}})}),y(R,q)},$$slots:{default:!0}})}),y(F,D)},$$slots:{default:!0}})});var A=$(C,2);E(A,()=>ct,(O,S)=>{S(O,{children:(F,G)=>{var D=Jo(),L=J(D);E(L,()=>dt,(X,k)=>{k(X,{children:(R,de)=>{var q=Vo(),U=J(q);os(U,{get item(){return e.avatarItem},get altText(){return e.avatarItem.release_group_name}});var Q=$(U),he=$(Q);lt(he,{}),nt(()=>ls(Q,` ${e.displayName??"display name"} `)),y(R,q)},$$slots:{default:!0}})});var te=$(L,2);E(te,()=>ut,(X,k)=>{k(X,{children:(R,de)=>{var q=Wo(),U=J(q);const Q=$e(()=>`/user/${e.username}`);E(U,()=>ue,(N,ge)=>{ge(N,{get href(){return T(Q)},children:(V,De)=>{z();var ye=ce("profile");y(V,ye)},$$slots:{default:!0}})});var he=$(U,2);const re=$e(()=>`/user/${e.username}/collections`);E(he,()=>ue,(N,ge)=>{ge(N,{get href(){return T(re)},children:(V,De)=>{z();var ye=ce("my collections");y(V,ye)},$$slots:{default:!0}})});var ie=$(he,2);const we=$e(()=>`/user/${e.username}/now-playing-posts`);E(ie,()=>ue,(N,ge)=>{ge(N,{get href(){return T(we)},children:(V,De)=>{z();var ye=ce("my posts");y(V,ye)},$$slots:{default:!0}})});var M=$(ie,2);E(M,()=>ue,(N,ge)=>{ge(N,{href:"/account",children:(V,De)=>{z();var ye=ce("account");y(V,ye)},$$slots:{default:!0}})});var x=$(M,2);E(x,()=>ue,(N,ge)=>{ge(N,{href:"/sign-out",children:(V,De)=>{z();var ye=ce("sign out");y(V,ye)},$$slots:{default:!0}})}),y(R,q)},$$slots:{default:!0}})}),y(F,D)},$$slots:{default:!0}})}),y(p,b)},u=p=>{var b=Zo(),v=J(b);E(v,()=>ct,(P,C)=>{C(P,{children:(A,O)=>{var S=Yo(),F=J(S);E(F,()=>dt,(D,L)=>{L(D,{children:(te,X)=>{z();var k=Xo(),R=$(J(k));lt(R,{}),y(te,k)},$$slots:{default:!0}})});var G=$(F,2);E(G,()=>ut,(D,L)=>{L(D,{children:(te,X)=>{var k=Qo(),R=J(k);E(R,()=>ue,(q,U)=>{U(q,{href:"/collections",children:(Q,he)=>{z();var re=ce("Collections");y(Q,re)},$$slots:{default:!0}})});var de=$(R,2);E(de,()=>ue,(q,U)=>{U(q,{href:"/posts",children:(Q,he)=>{z();var re=ce("Posts");y(Q,re)},$$slots:{default:!0}})}),y(te,k)},$$slots:{default:!0}})}),y(A,S)},$$slots:{default:!0}})}),z(4),y(p,b)};Ze(o,p=>{e.sessionUserId?p(l):p(u,!1)})}Xe(a);var c=$(a,2),d=Ge(c);{var h=p=>{var b=al(),v=J(b);E(v,()=>ct,(C,A)=>{A(C,{children:(O,S)=>{var F=rl(),G=J(F);E(G,()=>dt,(L,te)=>{te(L,{children:(X,k)=>{z();var R=el(),de=$(J(R));lt(de,{}),y(X,R)},$$slots:{default:!0}})});var D=$(G,2);E(D,()=>ut,(L,te)=>{te(L,{children:(X,k)=>{var R=tl(),de=J(R);E(de,()=>ue,(M,x)=>{x(M,{href:"/feed",children:(N,ge)=>{z();var V=ce("feed");y(N,V)},$$slots:{default:!0}})});var q=$(de,2);E(q,()=>ue,(M,x)=>{x(M,{href:"/feed/firehose",children:(N,ge)=>{z();var V=ce("universal feed");y(N,V)},$$slots:{default:!0}})});var U=$(q,2);E(U,()=>ue,(M,x)=>{x(M,{href:"/posts/now-playing/new",children:(N,ge)=>{z();var V=ce("new post");y(N,V)},$$slots:{default:!0}})});var Q=$(U,2);E(Q,()=>ue,(M,x)=>{x(M,{href:"/collection/new",children:(N,ge)=>{z();var V=ce("new collection");y(N,V)},$$slots:{default:!0}})});var he=$(Q,2);E(he,()=>ue,(M,x)=>{x(M,{href:"/about",children:(N,ge)=>{z();var V=ce("about");y(N,V)},$$slots:{default:!0}})});var re=$(he,2);E(re,()=>ue,(M,x)=>{x(M,{href:"/about/updates",children:(N,ge)=>{z();var V=ce("updates");y(N,V)},$$slots:{default:!0}})});var ie=$(re,2);E(ie,()=>ue,(M,x)=>{x(M,{href:"/collections",children:(N,ge)=>{z();var V=ce("discover collections");y(N,V)},$$slots:{default:!0}})});var we=$(ie,2);E(we,()=>ue,(M,x)=>{x(M,{href:"/users",children:(N,ge)=>{z();var V=ce("discover users");y(N,V)},$$slots:{default:!0}})}),y(X,R)},$$slots:{default:!0}})}),y(O,F)},$$slots:{default:!0}})});var P=$(v,2);E(P,()=>ct,(C,A)=>{A(C,{children:(O,S)=>{var F=il(),G=J(F);E(G,()=>dt,(L,te)=>{te(L,{children:(X,k)=>{var R=sl(),de=J(R);os(de,{get item(){return e.avatarItem},get altText(){return e.avatarItem.release_group_name}});var q=$(de),U=$(q);lt(U,{}),nt(()=>ls(q,` ${e.displayName??"display name"} `)),y(X,R)},$$slots:{default:!0}})});var D=$(G,2);E(D,()=>ut,(L,te)=>{te(L,{children:(X,k)=>{var R=nl(),de=J(R);const q=$e(()=>`/user/${e.username}`);E(de,()=>ue,(M,x)=>{x(M,{get href(){return T(q)},children:(N,ge)=>{z();var V=ce("profile");y(N,V)},$$slots:{default:!0}})});var U=$(de,2);E(U,()=>ue,(M,x)=>{x(M,{href:"/account",children:(N,ge)=>{z();var V=ce("account");y(N,V)},$$slots:{default:!0}})});var Q=$(U,2);const he=$e(()=>`/user/${e.username}/collections`);E(Q,()=>ue,(M,x)=>{x(M,{get href(){return T(he)},children:(N,ge)=>{z();var V=ce("my collections");y(N,V)},$$slots:{default:!0}})});var re=$(Q,2);const ie=$e(()=>`/user/${e.username}/now-playing-posts`);E(re,()=>ue,(M,x)=>{x(M,{get href(){return T(ie)},children:(N,ge)=>{z();var V=ce("my posts");y(N,V)},$$slots:{default:!0}})});var we=$(re,2);E(we,()=>ue,(M,x)=>{x(M,{href:"/sign-out",children:(N,ge)=>{z();var V=ce("sign out");y(N,V)},$$slots:{default:!0}})}),y(X,R)},$$slots:{default:!0}})}),y(O,F)},$$slots:{default:!0}})}),y(p,b)},g=p=>{var b=ul(),v=J(b);E(v,()=>ct,(P,C)=>{C(P,{children:(A,O)=>{var S=cl(),F=J(S);E(F,()=>dt,(D,L)=>{L(D,{children:(te,X)=>{z();var k=ol(),R=$(J(k));lt(R,{}),y(te,k)},$$slots:{default:!0}})});var G=$(F,2);E(G,()=>ut,(D,L)=>{L(D,{children:(te,X)=>{var k=ll(),R=J(k);E(R,()=>ue,(U,Q)=>{Q(U,{href:"/about",children:(he,re)=>{z();var ie=ce("About");y(he,ie)},$$slots:{default:!0}})});var de=$(R,2);E(de,()=>ue,(U,Q)=>{Q(U,{href:"/collections",children:(he,re)=>{z();var ie=ce("Collections");y(he,ie)},$$slots:{default:!0}})});var q=$(de,2);E(q,()=>ue,(U,Q)=>{Q(U,{href:"/posts",children:(he,re)=>{z();var ie=ce("Posts");y(he,ie)},$$slots:{default:!0}})}),y(te,k)},$$slots:{default:!0}})}),y(A,S)},$$slots:{default:!0}})}),z(2),y(p,b)};Ze(d,p=>{e.sessionUserId?p(h):p(g,!1)})}Xe(c),Xe(r),z(2),Xe(t),y(s,t),Vt()}var fl=ee('<!> <div class="double-border-full-vw"></div> <!> <div class="buffer svelte-gc6ymb"></div>',1);function Ql(s,e){Ht(e,!0);let t=$e(()=>e.data.session),r=$e(()=>e.data.sessionUserId),n=$e(()=>e.data.supabase),i=$e(()=>e.data.profile),a=$e(()=>T(i).username),o=$e(()=>T(i).display_name),l=$e(()=>T(i).avatar_url),u=$e(()=>T(i).avatar_last_fm_img_url),c=$e(()=>T(i).avatar_artist_name),d=$e(()=>T(i).avatar_release_group_name),h=$e(()=>({img_url:T(l),last_fm_img_url:T(u),artist_name:T(c),release_group_name:T(d)}));kn(()=>{const{data:v}=T(n).auth.onAuthStateChange((P,C)=>{var A;(C==null?void 0:C.expires_at)!==((A=T(t))==null?void 0:A.expires_at)&&En("supabase:auth")});return()=>v.subscription.unsubscribe()});var g=fl(),p=J(g);hl(p,{get sessionUserId(){return T(r)},get username(){return T(a)},get displayName(){return T(o)},get avatarItem(){return T(h)}});var b=$(p,4);bn(b,()=>e.children),z(2),y(s,g),Vt()}export{Ql as component,Xl as universal};
